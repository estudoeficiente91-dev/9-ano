<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>A Droga da Obedi√™ncia ‚Äì 7¬∫ Ano</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        :root{
            --bg:#111827; 
            --card:#1f2937; 
            --accent:#818cf8; 
            --muted:#9ca3af; 
            --text:#e5e7eb;
            --success:#34d399;
            --danger:#f87171; 
            --border:rgba(255,255,255,0.1); 
            --muted-2: rgba(230,238,248,0.9);
        }
        html,body{height:100%;margin:0;font-family:Inter, system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial; background:var(--bg); color:var(--text);}
        .container{max-width:980px;margin:28px auto;padding:18px}
        .page-header{ padding:1.25rem; border-radius:12px; background: linear-gradient(180deg, rgba(129, 140, 248, 0.06), transparent); box-shadow: 0 8px 24px rgba(2,6,23,0.6); }
        .card{ background: var(--card); color: var(--text); border: 1px solid var(--border); border-radius: 12px; box-shadow: 0 6px 20px rgba(2,6,23,0.6); padding:18px }
        .btn-primary{ background: linear-gradient(90deg,var(--accent), #6366f1); color: #ffffff; padding: .5rem 1.25rem; border-radius: 10px; border: 1px solid rgba(255,255,255,0.2); box-shadow: 0 6px 18px rgba(129, 140, 248, 0.12); cursor: pointer; }
        .btn-ghost{ background: transparent; color: var(--muted-2); padding: .45rem .9rem; border-radius: 10px; border: 1px solid var(--border); cursor:pointer; }
        .option-btn{ display:block; width:100%; text-align:left; padding:.75rem 1rem; border-radius:10px; background: rgba(255,255,255,0.02); border:1px solid var(--border); color:var(--muted-2); cursor:pointer; transition: transform 150ms ease, background 150ms ease; }
        .option-btn:hover:not(:disabled){ background: rgba(255,255,255,0.035); transform: translateY(-1px); }
        .option-btn.correct{ background: var(--success) !important; color: #062e1f !important; border-color: rgba(4,120,87,0.18) !important; }
        .option-btn.wrong{ background: var(--danger) !important; color: #fff !important; border-color: rgba(185,28,28,0.18) !important; }
        .option-btn:disabled { cursor: not-allowed; }
        #question-buttons{ display:flex; flex-wrap:wrap; gap:8px; }
        #question-buttons button { 
            position: relative;
            background: transparent; 
            color: var(--muted-2); 
            border:1px solid var(--border); 
            padding:.45rem .6rem; 
            border-radius:8px; 
            cursor:pointer; 
            min-width: 42px;
        }
        #question-buttons button.current-question { background-color: rgba(129, 140, 248, 0.2); border-color: var(--accent); }
        #question-buttons button.correct-status { background-color: var(--success); color: #062e1f; border-color: var(--success); }
        #question-buttons button.wrong-status { background-color: var(--danger); color: white; border-color: var(--danger); }
        .feedback-correct{ background: rgba(16,185,129,0.12); border:1px solid rgba(16,185,129,0.22); color: #bbf7d0; padding:12px; border-radius:8px }
        .feedback-wrong{ background: rgba(239,68,68,0.12); border:1px solid rgba(239,68,68,0.22); color: #ffdede; padding:12px; border-radius:8px }
        .celebrate{ animation: pop 480ms cubic-bezier(.2,.9,.3,1); box-shadow: 0 12px 36px rgba(129, 140, 248, 0.18), 0 0 28px rgba(16,185,129,0.12); }
        @keyframes pop{ 0%{ transform: scale(1); } 50%{ transform: scale(1.08); } 100%{ transform: scale(1); } }
        .confetti{ position: fixed; z-index: 9999; pointer-events: none; font-size: 18px; opacity: 1; transform-origin: center; }
        @keyframes confetti-fall { 0%{ transform: translateY(-10vh) rotate(0deg); opacity:1 } 100%{ transform: translateY(100vh) rotate(540deg); opacity:0 } }
        
        .theme-light{ 
            --bg: #ffffff; 
            --card: #f9fafb; 
            --muted: #4b5563; 
            --text: #111827; 
            --accent: #4f46e5; 
            --success: #047857; 
            --danger: #b91c1c; 
            --border: rgba(15,23,42,0.1); 
            --muted-2: rgba(17, 24, 39, 0.9);
        }
        .topic-section { margin-bottom: 2.5rem; border-left: 3px solid var(--accent); padding-left: 1.5rem; }
        .topic-title { font-size: 1.5rem; font-weight: 700; color: var(--accent); margin-bottom: 1rem; }
        .sub-topic-title { font-size: 1.15rem; font-weight: 600; color: var(--text); margin-top: 1.5rem; margin-bottom: 0.75rem; }
        .topic-section p, .topic-section ul { font-size: 1rem; color: var(--muted-2); line-height: 1.7; text-align: justify; }
        .topic-section ul { list-style-position: inside; list-style-type: disc; margin-top: 0.5rem; padding-left: 1rem;}
        .highlight { background-color: rgba(129, 140, 248, 0.1); padding: 0.2rem 0.4rem; border-radius: 4px; font-weight: 600; color: var(--accent); }
        
        .difficulty-badge { padding: 0.1rem 0.6rem; border-radius: 99px; font-size: 0.75rem; font-weight: 600; text-transform: uppercase; }
        .difficulty-facil { background-color: rgba(52, 211, 153, 0.2); color: #6ee7b7; }
        .difficulty-medio { background-color: rgba(250, 204, 21, 0.2); color: #facc15; }
        .difficulty-dificil { background-color: rgba(248, 113, 113, 0.2); color: #f87171; }
        
        .difficulty-dot {
            position: absolute;
            top: 2px;
            right: 2px;
            width: 6px;
            height: 6px;
            border-radius: 50%;
        }
        .difficulty-facil-dot { background-color: #34d399; }
        .difficulty-medio-dot { background-color: #facc15; }
        .difficulty-dificil-dot { background-color: #ef4444; }
    </style>
</head>
<body class="antialiased">
    <div class="container">
        <header class="page-header">
            <div class="flex justify-between items-center">
                <div>
                    <h1 class="text-2xl font-bold">A Droga da Obedi√™ncia</h1>
                    <p class="text-sm text-slate-400">Guia de estudos: Personagens, Enredo e Temas (7¬∫ Ano).</p>
                </div>
                <div>
                    <button id="theme-toggle" class="btn-ghost">Tema</button>
                </div>
            </div>
        </header>

        <main class="mt-6">
            <div class="card">
                <nav class="mb-4">
                    <button id="btn-learn" class="btn-primary">Aprender</button>
                    <button id="btn-practice" class="btn-ghost ml-2">Praticar</button>
                    <!-- Bot√£o Flashcards removido -->
                </nav>

                <section id="learn-section">
                    <div class="space-y-8">
                        
                        <div class="topic-section">
                            <h2 class="topic-title">Os Karas: Quem S√£o Eles?</h2>
                            <p>"A Droga da Obedi√™ncia" √© o primeiro livro da s√©rie "Os Karas", escrita por Pedro Bandeira. A trama gira em torno de um grupo de cinco estudantes muito inteligentes do <span class="highlight">Col√©gio Elite</span>, em S√£o Paulo, que formam um grupo secreto de detetives.</p>
                            <h3 class="sub-topic-title">Membros do Grupo</h3>
                            <ul>
                                <li><strong>Miguel:</strong> O <span class="highlight">l√≠der</span> e fundador do grupo. √â corajoso, inteligente e tem o poder de unir a todos.</li>
                                <li><strong>Cr√¢nio:</strong> O <span class="highlight">g√™nio</span> cient√≠fico do grupo. √â o c√©rebro por tr√°s das inven√ß√µes e da l√≥gica, sendo um mestre no xadrez.</li>
                                <li><strong>Magr√≠:</strong> A <span class="highlight">atleta</span>. √â a √∫nica menina do grupo, uma ginasta ol√≠mpica premiada. Sua agilidade f√≠sica √© crucial para as miss√µes.</li>
                                <li><strong>Cal√∫:</strong> O <span class="highlight">ator</span> do grupo. √â extrovertido, popular e tem uma incr√≠vel capacidade de criar disfarces e interpretar personagens, sendo √≥timo para infiltra√ß√£o.</li>
                                <li><strong>Chumbinho:</strong> O membro mais novo, que n√£o estuda no Elite. Ele se junta ao grupo ap√≥s descobri-los e se torna o especialista em espionagem e o "homem-bomba" (carregando os aparelhos de Cr√¢nio).</li>
                            </ul>
                        </div>
                        
                        <div class="topic-section">
                             <h2 class="topic-title">O Mist√©rio e a Droga</h2>
                             <h3 class="sub-topic-title">O Problema</h3>
                             <p>A trama come√ßa quando Os Karas percebem um padr√£o estranho: alunos de v√°rios dos melhores col√©gios de S√£o Paulo est√£o desaparecendo e, quando reaparecem, est√£o mudados. Eles se tornam alunos "perfeitos": <span class="highlight">obedientes, quietos, tiram notas m√°ximas</span>, mas perdem completamente a personalidade, a criatividade e o <span class="highlight">livre-arb√≠trio</span>.</p>
                             
                             <h3 class="sub-topic-title">A Investiga√ß√£o</h3>
                             <p>Os Karas decidem investigar e descobrem que esses alunos est√£o sendo sequestrados e levados para um laborat√≥rio secreto. L√°, eles s√£o for√ßados a tomar uma poderosa subst√¢ncia qu√≠mica: a <span class="highlight">"Droga da Obedi√™ncia"</span>.</p>
                             <p>O vil√£o por tr√°s de tudo √© o misterioso <span class="highlight">Doutor Q.I.</span> (sigla para "Quer-√çndice"), que acredita que a juventude est√° perdida e que, para criar uma sociedade perfeita, √© preciso eliminar a "rebeldia" e a vontade pr√≥pria, deixando apenas a intelig√™ncia e a obedi√™ncia.</p>
                        </div>

                        <div class="topic-section">
                            <h2 class="topic-title">Temas Principais do Livro</h2>
                            <p>O livro √© uma aventura de mist√©rio, mas tamb√©m discute temas muito importantes:</p>
                            <ul>
                                <li><strong>O Perigo do Autoritarismo:</strong> O Doutor Q.I. representa uma ditadura. Ele quer controlar a mente de todos em nome de uma suposta "ordem" ou "perfei√ß√£o".</li>
                                <li><strong>Livre-Arb√≠trio vs. Obedi√™ncia Cega:</strong> O livro mostra que a obedi√™ncia sem questionamento n√£o √© uma virtude. Os Karas, com sua "rebeldia" saud√°vel, provam que questionar e pensar por si mesmo √© o que nos torna humanos.</li>
                                <li><strong>Amizade e Uni√£o:</strong> Nenhum dos Karas conseguiria resolver o mist√©rio sozinho. Eles vencem porque <span class="highlight">unem suas habilidades diferentes</span> (a lideran√ßa de Miguel, a intelig√™ncia de Cr√¢nio, a agilidade de Magr√≠, o disfarce de Cal√∫ e a coragem de Chumbinho).</li>
                            </ul>
                        </div>
                        
                    </div>
                </section>

                <section id="practice-section" class="hidden">
                     <div class="mb-4 flex justify-end">
                        <button id="order-toggle-btn" class="btn-ghost text-xs">Ordem Crescente</button>
                    </div>
                    <div id="question-buttons" class="mb-4"></div>
                    <div id="quiz-container">
                    </div>
                </section>
                
                <!-- Se√ß√£o Flashcards Removida -->

            </div>
        </main>
    </div>

    <script>
    document.addEventListener('DOMContentLoaded', () => {
        const root = document.documentElement;
        const themeToggle = document.getElementById('theme-toggle');
        const btnLearn = document.getElementById('btn-learn');
        const btnPractice = document.getElementById('btn-practice');
        // Bot√£o Flashcards removido
        const learnSection = document.getElementById('learn-section');
        const practiceSection = document.getElementById('practice-section');
        // Se√ß√£o Flashcards removida
        
        const quizContainer = document.getElementById('quiz-container');
        const questionButtons = document.getElementById('question-buttons');
        const orderToggleBtn = document.getElementById('order-toggle-btn');
        
        // Vari√°veis Flashcards removidas

        if(!btnLearn || !btnPractice || !learnSection || !practiceSection || !questionButtons || !quizContainer || !orderToggleBtn){
            console.error('Elementos DOM n√£o encontrados.');
            return;
        }

        (function(){
            const t = localStorage.getItem('cmf-karas-7ano-theme') || 'dark';
            if(t === 'light') root.classList.add('theme-light');
            themeToggle.addEventListener('click', () => {
                root.classList.toggle('theme-light');
                localStorage.setItem('cmf-karas-7ano-theme', root.classList.contains('theme-light') ? 'light' : 'dark');
            });
        })();
        
        const quizData = [
            { topic: 'Personagens', difficulty: 'F√°cil', q: '1) Qual √© o nome do grupo de detetives secreto do Col√©gio Elite?', options: ['Os Ninjas', 'Os Karas', 'A Turma da Droga', 'Os Vingadores'], answer: 'Os Karas', explanation: 'O nome "Karas" foi escolhido por Miguel, o l√≠der, por ser uma palavra japonesa que significa "vazio", indicando que eles eram secretos.'},
            { topic: 'Personagens', difficulty: 'F√°cil', q: '2) Quem √© o l√≠der e fundador do grupo "Os Karas"?', options: ['Cr√¢nio', 'Cal√∫', 'Miguel', 'Chumbinho'], answer: 'Miguel', explanation: 'Miguel √© o presidente do gr√™mio estudantil e o l√≠der que organiza as miss√µes do grupo.'},
            { topic: 'Personagens', difficulty: 'F√°cil', q: '3) Qual personagem √© o g√™nio cient√≠fico e jogador de xadrez do grupo?', options: ['Cal√∫', 'Cr√¢nio', 'Miguel', 'Magr√≠'], answer: 'Cr√¢nio', explanation: 'Cr√¢nio √© o membro mais inteligente, respons√°vel pelos planos, inven√ß√µes e pela decodifica√ß√£o de enigmas.'},
            { topic: 'Personagens', difficulty: 'F√°cil', q: '4) Qual √© a principal habilidade de Magr√≠, a √∫nica menina do grupo?', options: ['√â especialista em computadores', '√â uma excelente atriz', '√â uma ginasta ol√≠mpica', '√â a mais forte do grupo'], answer: '√â uma ginasta ol√≠mpica', explanation: 'A agilidade de Magr√≠, treinada na gin√°stica, √© essencial para que ela possa escalar e se infiltrar em locais dif√≠ceis.'},
            { topic: 'Personagens', difficulty: 'M√©dio', q: '5) Qual personagem √© conhecido por sua habilidade de atuar e criar disfarces?', options: ['Miguel', 'Chumbinho', 'Cr√¢nio', 'Cal√∫'], answer: 'Cal√∫', explanation: 'Cal√∫ √© o ator do grupo, capaz de se passar por diferentes pessoas para conseguir informa√ß√µes.'},
            { topic: 'Personagens', difficulty: 'M√©dio', q: '6) Quem √© Chumbinho?', options: ['O diretor do Col√©gio Elite', 'O vil√£o principal do livro', 'O membro mais novo dos Karas, que n√£o estuda no Elite', 'O professor de qu√≠mica'], answer: 'O membro mais novo dos Karas, que n√£o estuda no Elite', explanation: 'Chumbinho √© um garoto corajoso que descobre o grupo e se torna o "agente de campo" deles.'},
            { topic: 'Enredo', difficulty: 'F√°cil', q: '7) Qual √© o principal mist√©rio que "Os Karas" investigam no livro?', options: ['O roubo de um quadro famoso', 'O desaparecimento e a mudan√ßa de comportamento de estudantes', 'Um esquema de corrup√ß√£o na prefeitura', 'A polui√ß√£o de um rio pr√≥ximo'], answer: 'O desaparecimento e a mudan√ßa de comportamento de estudantes', explanation: 'Eles percebem que alunos de v√°rios col√©gios est√£o sumindo e voltando estranhamente obedientes.'},
            { topic: 'Enredo', difficulty: 'F√°cil', q: '8) Qual √© o nome da subst√¢ncia que o vil√£o usa nos estudantes?', options: ['A Droga da Felicidade', 'A Po√ß√£o da Intelig√™ncia', 'O Soro da Verdade', 'A Droga da Obedi√™ncia'], answer: 'A Droga da Obedi√™ncia', explanation: 'A droga eliminava o livre-arb√≠trio, tornando os jovens d√≥ceis e obedientes.'},
            { topic: 'Enredo', difficulty: 'M√©dio', q: '9) O que acontecia com os alunos que tomavam a "Droga da Obedi√™ncia"?', options: ['Eles ficavam agressivos e rebeldes', 'Eles esqueciam seus nomes', 'Eles se tornavam obedientes e sem personalidade, como rob√¥s', 'Eles desenvolviam superpoderes'], answer: 'Eles se tornavam obedientes e sem personalidade, como rob√¥s', explanation: 'O objetivo do vil√£o era criar alunos "perfeitos" que apenas obedecessem, sem questionar.'},
            { topic: 'Enredo', difficulty: 'F√°cil', q: '10) Onde os Karas estudam?', options: ['Col√©gio Estadual de S√£o Paulo', 'Col√©gio Elite', 'Escola Municipal Pedro Bandeira', 'Col√©gio Objetivo'], answer: 'Col√©gio Elite', explanation: 'O Col√©gio Elite √© o cen√°rio principal onde o grupo se re√∫ne e estuda.'},
            { topic: 'Enredo', difficulty: 'Dif√≠cil', q: '11) Como Chumbinho consegue se infiltrar no esconderijo do vil√£o?', options: ['Disfar√ßado de entregador de pizza', 'Fingindo ser um dos alunos sequestrados', 'Escalando as paredes com Magr√≠', 'Usando um mapa secreto de Cr√¢nio'], answer: 'Fingindo ser um dos alunos sequestrados', explanation: 'Chumbinho se passa por uma das v√≠timas para ser levado ao laborat√≥rio e descobrir a localiza√ß√£o.'},
            { topic: 'Enredo', difficulty: 'M√©dio', q: '12) Onde ficava o laborat√≥rio secreto do Doutor Q.I.?', options: ['Nos t√∫neis do metr√¥', 'No por√£o do Col√©gio Elite', 'Em uma ilha deserta', 'Em um complexo subterr√¢neo disfar√ßado'], answer: 'Em um complexo subterr√¢neo disfar√ßado', explanation: 'O esconderijo era uma base secreta de alta tecnologia, dif√≠cil de encontrar.'},
            { topic: 'Enredo', difficulty: 'M√©dio', q: '13) Qual personagem dos Karas √© capturado e quase toma a droga?', options: ['Miguel', 'Magr√≠', 'Cal√∫', 'Cr√¢nio'], answer: 'Magr√≠', explanation: 'Magr√≠ √© capturada durante a investiga√ß√£o e quase se torna uma v√≠tima do Doutor Q.I.'},
            { topic: 'Vil√£o e Temas', difficulty: 'F√°cil', q: '14) Quem √© o grande vil√£o da hist√≥ria?', options: ['O diretor do Col√©gio Elite', 'O Doutor Q.I.', 'O pai de Miguel', 'Um agente secreto internacional'], answer: 'O Doutor Q.I.', explanation: 'Doutor Q.I. (Quer-√çndice) √© o cientista louco que quer dominar a mente dos jovens mais inteligentes do pa√≠s.'},
            { topic: 'Vil√£o e Temas', difficulty: 'M√©dio', q: '15) Qual era o objetivo final do Doutor Q.I. ao aplicar a droga?', options: ['Vender a droga para outros pa√≠ses', 'Criar um ex√©rcito de jovens superinteligentes e obedientes para dominar o Brasil', 'Curar os alunos de sua rebeldia', 'Ganhar um pr√™mio Nobel de qu√≠mica'], answer: 'Criar um ex√©rcito de jovens superinteligentes e obedientes para dominar o Brasil', explanation: 'Ele acreditava que o livre-arb√≠trio e a rebeldia eram defeitos, e queria criar uma sociedade "perfeita" sob seu controle.'},
            { topic: 'Vil√£o e Temas', difficulty: 'M√©dio', q: '16) O livro "A Droga da Obedi√™ncia" faz uma cr√≠tica a qual tipo de sistema?', options: ['Sistemas democr√°ticos e livres', 'Sistemas autorit√°rios e ditatoriais', 'A liberdade de imprensa', 'As escolas de per√≠odo integral'], answer: 'Sistemas autorit√°rios e ditatoriais', explanation: 'A droga √© uma met√°fora para regimes que exigem obedi√™ncia cega e n√£o aceitam questionamentos.'},
            { topic: 'Vil√£o e Temas', difficulty: 'F√°cil', q: '17) Qual √© a principal mensagem do livro sobre a "obedi√™ncia"?', options: ['Que obedecer √© sempre a melhor op√ß√£o', 'Que a obedi√™ncia cega √© perigosa e anula o indiv√≠duo', 'Que apenas crian√ßas devem obedecer', 'Que a desobedi√™ncia leva ao caos'], answer: 'Que a obedi√™ncia cega √© perigosa e anula o indiv√≠duo', explanation: 'O livro defende o pensamento cr√≠tico, a rebeldia saud√°vel e o livre-arb√≠trio como valores mais importantes.'},
            { topic: 'Vil√£o e Temas', difficulty: 'M√©dio', q: '18) O que √© o "livre-arb√≠trio", o principal alvo da droga do Doutor Q.I.?', options: ['A capacidade de correr r√°pido', 'A capacidade de ser inteligente', 'A capacidade de escolher e tomar as pr√≥prias decis√µes', 'A capacidade de ficar rico'], answer: 'A capacidade de escolher e tomar as pr√≥prias decis√µes', explanation: 'A droga eliminava exatamente a vontade pr√≥pria, a criatividade e a capacidade de questionar.'},
            { topic: 'Personagens', difficulty: 'M√©dio', q: '19) Qual dos Karas √© descrito como o mais bonito e popular, usando isso em suas habilidades de atua√ß√£o?', options: ['Miguel', 'Cr√¢nio', 'Chumbinho', 'Cal√∫'], answer: 'Cal√∫', explanation: 'Cal√∫ √© o "gal√£" da turma, e usa seu charme e talento teatral para enganar os inimigos.'},
            { topic: 'Enredo', difficulty: 'F√°cil', q: '20) O que √© o "K" que d√° nome ao grupo "Os Karas"?', options: ['A inicial do nome do l√≠der', 'Um c√≥digo secreto para "Elite"', 'Um ideograma japon√™s que significa "vazio"', 'Um s√≠mbolo qu√≠mico'], answer: 'Um ideograma japon√™s que significa "vazio"', explanation: 'Miguel escolheu o nome para simbolizar que o grupo era secreto, como um "karat√™" de m√£os vazias, agindo nas sombras.'},
            { topic: 'Revis√£o Geral', difficulty: 'F√°cil', q: '21) Qual o nome do autor de "A Droga da Obedi√™ncia"?', options: ['Ziraldo', 'Mauricio de Sousa', 'Monteiro Lobato', 'Pedro Bandeira'], answer: 'Pedro Bandeira', explanation: 'Pedro Bandeira √© um dos autores mais famosos da literatura infantojuvenil brasileira e criador da s√©rie "Os Karas".'},
            { topic: 'Revis√£o Geral', difficulty: 'F√°cil', q: '22) A hist√≥ria se passa principalmente em qual cidade brasileira?', options: ['Rio de Janeiro', 'Salvador', 'Bras√≠lia', 'S√£o Paulo'], answer: 'S√£o Paulo', explanation: 'O Col√©gio Elite e a maioria das a√ß√µes do livro acontecem na cidade de S√£o Paulo.'},
            { topic: 'Revis√£o Geral', difficulty: 'Dif√≠cil', q: '23) Quem era, na verdade, o Doutor Q.I.?', options: ['O pr√≥prio Miguel, em um plano complexo', 'Um cientista americano disfar√ßado', 'O diretor de um cursinho rival', 'Um alien√≠gena'], answer: 'O diretor de um cursinho rival', explanation: 'O vil√£o era o diretor do cursinho "Q.I.", que queria dominar o pa√≠s com seus alunos "perfeitos".'},
            { topic: 'Revis√£o Geral', difficulty: 'M√©dio', q: '24) Qual foi o primeiro sinal que alertou Cr√¢nio de que algo estava errado com os alunos "perfeitos"?', options: ['Eles come√ßaram a tirar notas baixas', 'Eles se recusavam a jogar xadrez ou perdiam de prop√≥sito', 'Eles come√ßaram a falar outras l√≠nguas', 'Eles fugiram da escola'], answer: 'Eles se recusavam a jogar xadrez ou perdiam de prop√≥sito', explanation: 'Cr√¢nio percebeu que os melhores jogadores de xadrez perderam o "instinto" do jogo, a criatividade, tornando-se previs√≠veis.'},
            { topic: 'Revis√£o Geral', difficulty: 'M√©dio', q: '25) O que significa a sigla Q.I. do vil√£o?', options: ['Quociente de Intelig√™ncia', 'Qu√≠mica Internacional', 'Quer-√çndice', 'Quadro de Honra'], answer: 'Quer-√çndice', explanation: 'O nome do vil√£o era uma brincadeira com o nome do seu cursinho, que buscava os melhores "√≠ndices" de aprova√ß√£o.'},
            { topic: 'Revis√£o Geral', difficulty: 'F√°cil', q: '26) Qual o g√™nero liter√°rio principal do livro?', options: ['Romance de √©poca', 'Poesia l√≠rica', 'Suspense e mist√©rio juvenil', 'Fic√ß√£o cient√≠fica'], answer: 'Suspense e mist√©rio juvenil', explanation: '√â uma hist√≥ria de aventura e investiga√ß√£o voltada para o p√∫blico jovem.'},
            { topic: 'Revis√£o Geral', difficulty: 'M√©dio', q: '27) Como Os Karas conseguem vencer o Doutor Q.I. no final?', options: ['Chamando a pol√≠cia imediatamente', 'Usando suas habilidades combinadas para invadir a base e expor o plano', 'Fazendo um acordo com o vil√£o', 'Desistindo da investiga√ß√£o'], answer: 'Usando suas habilidades combinadas para invadir a base e expor o plano', explanation: 'A vit√≥ria s√≥ √© poss√≠vel pela uni√£o das diferentes habilidades de cada membro do grupo.'},
            { topic: 'Revis√£o Geral', difficulty: 'Dif√≠cil', q: '28) O que acontece com a "Droga da Obedi√™ncia" no final do livro?', options: ['√â vendida para o governo', '√â destru√≠da pelos Karas', 'O Doutor Q.I. foge com a f√≥rmula', 'Os Karas decidem us√°-la para o bem'], answer: '√â destru√≠da pelos Karas', explanation: 'Durante a invas√£o final, Cr√¢nio e Chumbinho conseguem destruir o laborat√≥rio e a f√≥rmula da droga.'},
            { topic: 'Revis√£o Geral', difficulty: 'F√°cil', q: '29) Qual a principal cr√≠tica que o livro faz √† educa√ß√£o?', options: ['Critica escolas que valorizam mais a obedi√™ncia e as notas do que o pensamento cr√≠tico', 'Critica a falta de aulas de educa√ß√£o f√≠sica', 'Critica o uso de uniformes', 'Critica as f√©rias escolares longas'], answer: 'Critica escolas que valorizam mais a obedi√™ncia e as notas do que o pensamento cr√≠tico', explanation: 'O livro sugere que um aluno "perfeito" que s√≥ obedece n√£o √© um aluno ideal, pois falta-lhe o livre-arb√≠trio.'},
            { topic: 'Revis√£o Geral', difficulty: 'M√©dio', q: '30) A droga afetava apenas os alunos considerados:', options: ['Os mais bagunceiros', 'Os mais inteligentes (g√™nios)', 'Os mais pobres', 'Os atletas'], answer: 'Os mais inteligentes (g√™nios)', explanation: 'O Doutor Q.I. sequestrava apenas os alunos com maior potencial intelectual para formar sua elite.'},
            { topic: 'Personagens', difficulty: 'M√©dio', q: '31) Qual personagem dos Karas √© fundamental para entrar no complexo do vil√£o usando os dutos de ventila√ß√£o?', options: ['Cr√¢nio', 'Cal√∫', 'Magr√≠', 'Miguel'], answer: 'Magr√≠', explanation: 'Sua habilidade como ginasta permitiu que ela usasse sua agilidade e tamanho para se infiltrar por locais imposs√≠veis para os outros.'},
            { topic: 'Vil√£o e Temas', difficulty: 'M√©dio', q: '32) A ideia de uma sociedade controlada, onde todos s√£o "iguais" e obedientes, √© uma caracter√≠stica de regimes:', options: ['Democr√°ticos', 'Liberais', 'Totalit√°rios', 'Anarquistas'], answer: 'Totalit√°rios', explanation: 'O plano do Dr. Q.I. espelha ideias de regimes totalit√°rios que suprimem a individualidade e a liberdade.'},
            { topic: 'Personagens', difficulty: 'M√©dio', q: '33) Qual o nome do inspetor de pol√≠cia que, inicialmente, n√£o acredita nos Karas?', options: ['Inspetor Silva', 'Delegado Joel', 'Inspetor Rodrigues', 'Detetive Andrade'], answer: 'Detetive Andrade', explanation: 'Andrade √© o policial adulto que, a princ√≠pio, duvida dos jovens detetives.'},
            { topic: 'Enredo', difficulty: 'M√©dio', q: '34) Qual era o disfarce da base secreta do Doutor Q.I.?', options: ['Uma f√°brica de refrigerantes', 'Um hospital abandonado', 'Um cursinho pr√©-vestibular', 'Uma academia de gin√°stica'], answer: 'Um cursinho pr√©-vestibular', explanation: 'O "Cursinho Q.I." era a fachada legal para as atividades criminosas do vil√£o.'},
            { topic: 'Revis√£o Geral', difficulty: 'F√°cil', q: '35) Os Karas s√£o um grupo de:', options: ['Professores', 'Pais de alunos', 'Estudantes', 'Policiais'], answer: 'Estudantes', explanation: 'S√£o alunos do ensino m√©dio que se re√∫nem secretamente para resolver mist√©rios.'},
            { topic: 'Revis√£o Geral', difficulty: 'M√©dio', q: '36) O livro critica a ideia de que a "rebeldia" juvenil √©:', options: ['Sempre positiva e deve ser incentivada', 'Sempre negativa e deve ser controlada', 'Uma fase natural que deve ser ignorada', 'Positiva quando √© usada para questionar e pensar'], answer: 'Positiva quando √© usada para questionar e pensar', explanation: 'Os Karas s√£o "rebeldes" no sentido de que questionam as regras e investigam, o que o livro trata como uma virtude.'},
            { topic: 'Personagens', difficulty: 'M√©dio', q: '37) Como Cr√¢nio descobre a localiza√ß√£o da base secreta?', options: ['Seguindo um mapa', 'Atrav√©s de um c√≥digo de xadrez', 'Analisando a composi√ß√£o qu√≠mica da droga', 'Hackeando o sistema da pol√≠cia'], answer: 'Analisando a composi√ß√£o qu√≠mica da droga', explanation: 'Cr√¢nio analisa uma amostra da droga e descobre um componente raro, tra√ßando sua origem at√© o laborat√≥rio.'},
            { topic: 'Revis√£o Geral', difficulty: 'Dif√≠cil', q: '38) Qual dos Karas √© o primeiro a ser internado como "paciente" na cl√≠nica do Doutor Q.I.?', options: ['Magr√≠', 'Cal√∫', 'Miguel', 'Chumbinho'], answer: 'Chumbinho', explanation: 'Chumbinho se infiltra fingindo ser um dos alunos sequestrados para descobrir o que acontece l√° dentro.'},
            { topic: 'Enredo', difficulty: 'M√©dio', q: '39) Qual √© o principal dilema moral do livro?', options: ['Vale a pena ser inteligente?', '√â correto sacrificar a liberdade individual em nome da ordem e da perfei√ß√£o?', 'Os fins justificam os meios?', 'A escola √© importante?'], answer: '√â correto sacrificar a liberdade individual em nome da ordem e da perfei√ß√£o?', explanation: 'Esse √© o conflito central proposto pelo plano do Doutor Q.I.'},
            { topic: 'Revis√£o Geral', difficulty: 'F√°cil', q: '40) Qual a principal li√ß√£o que "Os Karas" aprendem ao final da aventura?', options: ['Que adultos s√£o in√∫teis', 'Que o crime n√£o compensa', 'Que a uni√£o de suas habilidades diferentes √© sua maior for√ßa', 'Que a gin√°stica √© o esporte mais importante'], answer: 'Que a uni√£o de suas habilidades diferentes √© sua maior for√ßa', explanation: 'O livro refor√ßa a ideia de que a colabora√ß√£o e a valoriza√ß√£o das diferen√ßas de cada um s√£o essenciais para o sucesso.'}
        ];

        let questionOrder = quizData.map((_,i)=>i);
        let currentIndex = 0;
        let questionStatus = Array(quizData.length).fill(null);
        let quizStarted = false;
        let isRandomOrder = false; 
        let retryQueue = []; // Fila para as quest√µes erradas

        // DOM Elements for the quiz
        const questionInfoContainer = document.createElement('div');
        questionInfoContainer.className = 'flex justify-between items-center mb-2';
        const questionTopic = document.createElement('p');
        questionTopic.className='text-sm font-semibold text-[var(--accent)]';
        const questionDifficulty = document.createElement('span');
        const questionText = document.createElement('p');
        questionText.className='text-xl mt-2';
        const optionsContainer = document.createElement('div');
        optionsContainer.className='mt-4 grid gap-3';
        const feedbackContainer = document.createElement('div');
        const nextBtn = document.createElement('button');
        nextBtn.className='btn-primary mt-4 hidden';
        nextBtn.textContent='Pr√≥xima';
        
        quizContainer.appendChild(questionInfoContainer);
        quizContainer.appendChild(questionText);
        quizContainer.appendChild(optionsContainer);
        quizContainer.appendChild(feedbackContainer);
        quizContainer.appendChild(nextBtn);
        
        function setupNavEvents() {
            btnLearn.addEventListener('click', () => switchView('learn'));
            btnPractice.addEventListener('click', () => switchView('practice'));
            // Event listener do Flashcards removido
        }

        function switchView(view){
            learnSection.classList.add('hidden');
            practiceSection.classList.add('hidden');
            // Se√ß√£o Flashcards removida
            const flashcardBtn = document.getElementById('btn-flashcards');
            const flashcardSec = document.getElementById('flashcard-section');
            if (flashcardBtn) flashcardBtn.remove();
            if (flashcardSec) flashcardSec.remove();

            btnLearn.classList.replace('btn-primary', 'btn-ghost');
            btnPractice.classList.replace('btn-primary', 'btn-ghost');

            if(view === 'learn'){
                learnSection.classList.remove('hidden');
                btnLearn.classList.replace('btn-ghost', 'btn-primary');
            } else if (view === 'practice') {
                practiceSection.classList.remove('hidden');
                btnPractice.classList.replace('btn-ghost', 'btn-primary');
                if (!quizStarted) {
                    startQuiz();
                    quizStarted = true;
                }
            }
        }
        
        // --- Regular Quiz Logic ---

        orderToggleBtn.addEventListener('click', () => {
            isRandomOrder = !isRandomOrder; 
            orderToggleBtn.textContent = isRandomOrder ? 'Ordem Aleat√≥ria' : 'Ordem Crescente';
            startQuiz();
        });

        function renderQuestionButtons(buttonsEl, statusArr, index, orderArr){
            buttonsEl.innerHTML='';
            quizData.forEach((qObj,originalIndex)=>{ 
                const b = document.createElement('button');
                b.textContent = (originalIndex + 1);
                b.setAttribute('data-original-index', String(originalIndex));
                
                const dot = document.createElement('span');
                dot.className = `difficulty-dot difficulty-${qObj.difficulty.toLowerCase()}-dot`;
                b.appendChild(dot);
                
                b.title = `Quest√£o ${originalIndex+1}: Dificuldade ${qObj.difficulty}`;
                
                b.onclick = ()=>{
                    const pos = orderArr.indexOf(originalIndex);
                    if(pos >= 0){ 
                        currentIndex = pos; 
                        showQuestion(); 
                    }
                };
                if(statusArr[originalIndex]==='correct') b.classList.add('correct-status');
                if(statusArr[originalIndex]==='wrong') b.classList.add('wrong-status');
                
                if (quizStarted && index < quizData.length) {
                    const currentQuestionOriginalIndex = orderArr[index];
                    if(originalIndex === currentQuestionOriginalIndex) {
                        b.classList.add('current-question');
                    }
                }
                
                buttonsEl.appendChild(b);
            });
        }
        
        function startQuiz(){
            if (isRandomOrder) {
                shuffleArray(questionOrder);
            } else {
                questionOrder = quizData.map((_, i) => i);
            }
            currentIndex = 0;
            questionStatus.fill(null);
            retryQueue = []; // Limpa a fila de repeti√ß√£o
            showQuestion();
        }

        function showQuestion(){
            const finalResultsDiv = document.getElementById('final-results');
            if (finalResultsDiv) finalResultsDiv.remove();
            quizContainer.style.display = 'block';

            if (currentIndex >= questionOrder.length) {
                // Chegou ao fim da rodada
                if (retryQueue.length > 0) {
                    // Se h√° quest√µes para repetir
                    questionOrder = [...retryQueue]; // A nova ordem s√£o as quest√µes erradas
                    retryQueue = []; // Limpa a fila para a pr√≥xima rodada de repeti√ß√µes
                    currentIndex = 0;
                    shuffleArray(questionOrder); // Embaralha as quest√µes erradas
                    showQuestion(); // Mostra a primeira quest√£o errada
                    return;
                } else {
                    // N√£o h√° mais quest√µes erradas, fim do quiz
                    showFinalResults('practice');
                    return;
                }
            }
        
            const qIdx = questionOrder[currentIndex];
            const qObj = quizData[qIdx];
            
            questionInfoContainer.classList.remove('hidden');
            questionTopic.textContent = qObj.topic;
            questionDifficulty.textContent = qObj.difficulty;
            questionDifficulty.className = `difficulty-badge difficulty-${qObj.difficulty.toLowerCase()}`;
            
            questionText.innerHTML = `${qIdx + 1}) ${qObj.q.replace(/^[\s\d\)\(\.\:\-‚Äì‚Äî_]+/,'').trim()}`;
            
            optionsContainer.innerHTML='';
            feedbackContainer.innerHTML='';
            nextBtn.classList.add('hidden'); 
            
            qObj.options.forEach(opt =>{
                const b = document.createElement('button');
                b.className='option-btn'; 
                b.textContent=opt;
                b.onclick = ()=> selectAnswer(b, opt, qObj.answer, qObj.explanation, qIdx);
                optionsContainer.appendChild(b);
            });

            renderQuestionButtons(questionButtons, questionStatus, currentIndex, questionOrder);
        }
        
        function selectAnswer(btn,opt,correct,explanation,qIdx){
            Array.from(optionsContainer.children).forEach(b=> {
                b.disabled=true;
                if(b.textContent === correct) {
                    b.classList.add('correct');
                }
            });
            nextBtn.classList.remove('hidden');

            if(opt===correct){
                btn.classList.add('celebrate');
                createConfetti();
                questionStatus[qIdx]='correct';
                feedbackContainer.className='feedback-correct mt-4';
                feedbackContainer.textContent = 'Correto! ' + (explanation || '');
            } else {
                btn.classList.add('wrong');
                questionStatus[qIdx]='wrong';
                retryQueue.push(qIdx); // Adiciona a quest√£o √† fila de repeti√ß√£o
                feedbackContainer.className='feedback-wrong mt-4';
                feedbackContainer.innerHTML = `<strong>Errado.</strong> ${explanation || ''}`;
                // Bot√£o Refazer removido
            }
            renderQuestionButtons(questionButtons, questionStatus, currentIndex, questionOrder);
        }

        nextBtn.addEventListener('click', ()=>{
            currentIndex++; 
            showQuestion(); 
        });

        // --- Fun√ß√µes do Flashcard removidas ---
        
        // --- Fun√ß√µes Compartilhadas ---

        function showFinalResults(mode) {
            const statusArray = questionStatus;
            const container = quizContainer;
            const parentSection = practiceSection;

            const correctCount = statusArray.filter(s => s === 'correct').length;
            const total = quizData.length;
            
            container.style.display = 'none';

            let finalResultsDiv = document.createElement('div');
            finalResultsDiv.id = `final-results-${mode}`;
            finalResultsDiv.className = 'text-center';
            parentSection.appendChild(finalResultsDiv);

            finalResultsDiv.innerHTML = `
                <h2 class="text-2xl font-bold">üéâ Fim do Quiz! üéâ</h2>
                <p class="text-lg mt-4">Voc√™ acertou ${correctCount} de ${total} quest√µes.</p>
                <button id="restart-btn-${mode}" class="btn-primary mt-6">Recome√ßar</button>
            `;
            
            document.getElementById(`restart-btn-${mode}`).onclick = () => {
                quizStarted = false;
                startQuiz(); 
                quizStarted = true;
            };
        }

        function shuffleArray(a){
            for(let i=a.length-1;i>0;i--){ const j=Math.floor(Math.random()*(i+1)); [a[i],a[j]]=[a[j],a[i]]; }
        }

        function createConfetti(){
            const colors = ['#f59e0b','#ef4444','#10b981','#3b82f6','#8b5cf6'];
            for(let i=0;i<12;i++){
                const el = document.createElement('div');
                el.className='confetti';
                el.style.left = (30 + Math.random()*40) + '%';
                el.style.top = (10 + Math.random()*10) + 'vh';
                el.style.color = colors[Math.floor(Math.random()*colors.length)];
                el.textContent = 'üéâ';
                el.style.transform = `rotate(${Math.random()*360}deg)`;
                el.style.animation = `confetti-fall ${1.2 + Math.random()*1}s linear forwards`;
                document.body.appendChild(el);
                setTimeout(()=> el.remove(), 2200);
            }
        }
        
        setupNavEvents();
        switchView('learn');
    });
    </script>
</body>
</html>