<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Inglês – 7º Ano (TC)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        :root{
            --bg:#071023; --card:#0b1624; --accent:#3b82f6; --muted:#97a6bf; --text:#e6eef8; --success:#34d399; --danger:#ef4444; --border:rgba(255,255,255,0.12); --muted-2: rgba(230,238,248,0.85);
        }
        html,body{height:100%;margin:0;font-family:Inter, system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial; background:var(--bg); color:var(--text);}
        .container{max-width:980px;margin:28px auto;padding:18px}
        .page-header{ padding:1.25rem; border-radius:12px; background: linear-gradient(180deg, rgba(59,130,246,0.06), transparent); box-shadow: 0 8px 24px rgba(2,6,23,0.6); }
        .card{ background: var(--card); color: var(--text); border: 1px solid var(--border); border-radius: 12px; box-shadow: 0 6px 20px rgba(2,6,23,0.6); padding:18px }
        .btn-primary{ background: linear-gradient(90deg,var(--accent), #3b82f6); color: #061226; padding: .5rem 1.25rem; border-radius: 10px; border: 1px solid rgba(255,255,255,0.4); box-shadow: 0 6px 18px rgba(59,130,246,0.12); cursor: pointer; }
        .btn-ghost{ background: transparent; color: var(--muted-2); padding: .45rem .9rem; border-radius: 10px; border: 1px solid var(--border); cursor:pointer; }
        .option-btn{ display:block; width:100%; text-align:left; padding:.75rem 1rem; border-radius:10px; background: rgba(255,255,255,0.02); border:1px solid var(--border); color:var(--muted-2); cursor:pointer; transition: transform 150ms ease, background 150ms ease; }
        .option-btn:hover:not(:disabled){ background: rgba(255,255,255,0.035); transform: translateY(-1px); }
        .option-btn.correct{ background: var(--success) !important; color: #062e1f !important; border-color: rgba(4,120,87,0.18) !important; }
        .option-btn.wrong{ background: var(--danger) !important; color: #fff !important; border-color: rgba(185,28,28,0.18) !important; }
        .option-btn:disabled { cursor: not-allowed; }
        #question-buttons{ display:flex; flex-wrap:wrap; gap:8px; }
        #question-buttons button{ background: transparent; color: var(--muted-2); border:1px solid var(--border); padding:.45rem .6rem; border-radius:8px; cursor:pointer; }
        #question-buttons button.current-question { background-color: rgba(59, 130, 246, 0.2); border-color: var(--accent); }
        #question-buttons button.correct-status { background-color: var(--success); color: #062e1f; border-color: var(--success); }
        #question-buttons button.wrong-status { background-color: var(--danger); color: white; border-color: var(--danger); }
        .feedback-correct{ background: rgba(16,185,129,0.12); border:1px solid rgba(16,185,129,0.22); color: #bbf7d0; padding:12px; border-radius:8px }
        .feedback-wrong{ background: rgba(239,68,68,0.12); border:1px solid rgba(239,68,68,0.22); color: #ffdede; padding:12px; border-radius:8px }
        .celebrate{ animation: pop 480ms cubic-bezier(.2,.9,.3,1); box-shadow: 0 12px 36px rgba(96,165,250,0.18), 0 0 28px rgba(16,185,129,0.12); }
        @keyframes pop{ 0%{ transform: scale(1); } 50%{ transform: scale(1.08); } 100%{ transform: scale(1); } }
        .confetti{ position: fixed; z-index: 9999; pointer-events: none; font-size: 18px; opacity: 1; transform-origin: center; }
        @keyframes confetti-fall { 0%{ transform: translateY(-10vh) rotate(0deg); opacity:1 } 100%{ transform: translateY(100vh) rotate(540deg); opacity:0 } }
        .theme-light{ --bg: #f8fafc; --card: #ffffff; --muted: #475569; --text: #0f1724; --accent: #0284c7; --success: #047857; --danger: #b91c1c; --border: rgba(15,23,42,0.1); --muted-2: rgba(15,23,36,0.85); }
        .topic-section { margin-bottom: 2.5rem; border-left: 3px solid var(--accent); padding-left: 1.5rem; }
        .topic-title { font-size: 1.5rem; font-weight: 700; color: var(--accent); margin-bottom: 1rem; }
        .sub-topic-title { font-size: 1.15rem; font-weight: 600; color: var(--text); margin-top: 1.5rem; margin-bottom: 0.75rem; }
        .topic-section p, .topic-section ul { font-size: 1rem; color: var(--muted-2); line-height: 1.7; text-align: justify; }
        .topic-section ul { list-style-position: inside; list-style-type: disc; margin-top: 0.5rem; padding-left: 1rem;}
        .highlight { background-color: rgba(59, 130, 246, 0.1); padding: 0.2rem 0.4rem; border-radius: 4px; font-weight: 600; color: var(--accent); }
        .difficulty-badge { padding: 0.1rem 0.6rem; border-radius: 99px; font-size: 0.75rem; font-weight: 600; text-transform: uppercase; }
        .difficulty-facil { background-color: rgba(52, 211, 153, 0.2); color: #6ee7b7; }
        .difficulty-medio { background-color: rgba(250, 204, 21, 0.2); color: #facc15; }
        .difficulty-dificil { background-color: rgba(248, 113, 113, 0.2); color: #f87171; }
    </style>
</head>
<body class="antialiased">
    <div class="container">
        <header class="page-header">
            <div class="flex justify-between items-center">
                <div>
                    <h1 class="text-2xl font-bold">Inglês — 7º Ano (TC)</h1>
                    <p class="text-sm text-slate-400">Guia de estudos para a prova: Gramática e Vocabulário.</p>
                </div>
                <div>
                    <button id="theme-toggle" class="btn-ghost">Tema</button>
                </div>
            </div>
        </header>

        <main class="mt-6">
            <div class="card">
                <nav class="mb-4">
                    <button id="btn-learn" class="btn-primary">Aprender</button>
                    <button id="btn-practice" class="btn-ghost ml-2">Praticar</button>
                </nav>

                <section id="learn-section">
                    <div class="space-y-8">
                        
                        <div class="topic-section">
                            <h2 class="topic-title">Ordinal Numbers & Centuries (Números Ordinais e Séculos)</h2>
                            <h3 class="sub-topic-title">Como formar Números Ordinais</h3>
                            <p>Números ordinais indicam <span class="highlight">ordem ou posição</span> (primeiro, segundo, terceiro...).</p>
                            <ul>
                                <li><strong>Regra geral:</strong> Adicione <span class="highlight">-th</span> ao final do número.
                                    <ul>
                                        <li>four -> <span class="highlight">fourth</span> (4º)</li>
                                        <li>seven -> <span class="highlight">seventh</span> (7º)</li>
                                        <li>ten -> <span class="highlight">tenth</span> (10º)</li>
                                        <li>sixteen -> <span class="highlight">sixteenth</span> (16º)</li>
                                        <li>nineteen -> <span class="highlight">nineteenth</span> (19º)</li>
                                        <li>hundred -> <span class="highlight">hundredth</span> (100º)</li>
                                    </ul>
                                </li>
                                <li><strong>Exceções principais:</strong>
                                    <ul>
                                        <li>1: one -> <span class="highlight">first (1st)</span></li>
                                        <li>2: two -> <span class="highlight">second (2nd)</span></li>
                                        <li>3: three -> <span class="highlight">third (3rd)</span></li>
                                    </ul>
                                </li>
                                <li><strong>Outras exceções de escrita:</strong>
                                     <ul>
                                        <li>five -> <span class="highlight">fifth (5th)</span></li>
                                        <li>eight -> <span class="highlight">eighth (8th)</span></li>
                                        <li>nine -> <span class="highlight">ninth (9th)</span></li>
                                        <li>twelve -> <span class="highlight">twelfth (12th)</span></li>
                                    </ul>
                                </li>
                                <li><strong>Dezenas terminadas em 'y':</strong> Trocam 'y' por 'ieth'.
                                     <ul>
                                        <li>twenty -> <span class="highlight">twentieth</span> (20º)</li>
                                        <li>forty -> <span class="highlight">fortieth</span> (40º)</li>
                                        <li>ninety -> <span class="highlight">ninetieth</span> (90º)</li>
                                    </ul>
                                </li>
                                <li><strong>Números compostos:</strong> Apenas o último número vira ordinal.
                                     <ul>
                                        <li>twenty-one -> twenty-<span class="highlight">first</span> (21º)</li>
                                        <li>thirty-two -> thirty-<span class="highlight">second</span> (32º)</li>
                                        <li>forty-three -> forty-<span class="highlight">third</span> (43º)</li>
                                        <li>fifty-six -> fifty-<span class="highlight">sixth</span> (56º)</li>
                                        <li>eighty-eight -> eighty-<span class="highlight">eighth</span> (88º)</li>
                                        <li>one hundred and one -> one hundred and <span class="highlight">first</span> (101º)</li>
                                    </ul>
                                </li>
                            </ul>

                            <h3 class="sub-topic-title">Como Identificar o Século (Century)</h3>
                            <p>A regra é simples e funciona sempre:</p>
                            <ol class="list-decimal list-inside space-y-2 mt-2">
                                <li><strong>Se o ano terminar em "00":</strong> O século é o número formado pelos dois primeiros dígitos.
                                    <ul>
                                        <li>Ano 1500 -> <span class="highlight">15th century</span> (século XV)</li>
                                        <li>Ano 1900 -> <span class="highlight">19th century</span> (século XIX)</li>
                                        <li>Ano 2000 -> <span class="highlight">20th century</span> (século XX)</li>
                                    </ul>
                                </li>
                                <li><strong>Se o ano NÃO terminar em "00":</strong> Pegue o número formado pelos primeiros dígitos e some 1.
                                    <ul>
                                        <li>Ano 99 -> (0 + 1) -> <span class="highlight">1st century</span> (século I)</li>
                                        <li>Ano 725 -> (7 + 1) -> <span class="highlight">8th century</span> (século VIII)</li>
                                        <li>Ano 1453 -> (14 + 1) -> <span class="highlight">15th century</span> (século XV)</li>
                                        <li>Ano 2023 -> (20 + 1) -> <span class="highlight">21st century</span> (século XXI)</li>
                                    </ul>
                                </li>
                            </ol>
                        </div>
                        
                        <div class="topic-section">
                            <h2 class="topic-title">Simple Past & Past Continuous</h2>
                             <h3 class="sub-topic-title">Simple Past (Passado Simples)</h3>
                            <p>Usamos para ações <span class="highlight">completamente terminadas</span> em um tempo definido no passado (ontem, ano passado, etc.).</p>
                             <ul>
                                 <li><strong>Verbos Regulares:</strong> Adicione <span class="highlight">-ed</span>. Ex: "I <span class="highlight">worked</span> hard yesterday." (Eu trabalhei duro ontem).</li>
                                 <li><strong>Verbos Irregulares:</strong> Têm formas próprias. Ex: "She <span class="highlight">went</span> to the party last night." (Ela foi à festa na noite passada).</li>
                                 <li><strong>Negativa:</strong> Use <span class="highlight">did not (didn't) + verbo na forma base</span>. Ex: "He <span class="highlight">didn't see</span> the movie." (Ele não viu o filme).</li>
                                  <li><strong>Interrogativa:</strong> Use <span class="highlight">Did + sujeito + verbo na forma base</span>. Ex: "<span class="highlight">Did you do</span> your homework?" (Você fez sua tarefa?).</li>
                             </ul>
                             
                            <h3 class="sub-topic-title">Past Continuous (Passado Contínuo)</h3>
                             <p>Usamos para descrever uma ação que <span class="highlight">estava em progresso</span> em um momento específico do passado.</p>
                             <p><strong>Forma:</strong> <span class="highlight">was / were + verbo com -ing</span>.</p>
                              <ul>
                                 <li>"At 8 p.m. last night, I <span class="highlight">was watching</span> TV." (Às 20h de ontem, eu estava assistindo TV).</li>
                                 <li>"They <span class="highlight">were playing</span> soccer when I arrived." (Eles estavam jogando futebol quando eu cheguei).</li>
                             </ul>

                             <h3 class="sub-topic-title">Usando os Dois Juntos: A Interrupção</h3>
                             <p>A combinação dos dois tempos é muito comum. A ação longa que estava acontecendo (Past Continuous) é interrompida por uma ação curta e pontual (Simple Past).</p>
                             <ul>
                                 <li>"He <span class="highlight">was crossing</span> the street when he <span class="highlight">saw</span> the accident." (Ele estava atravessando a rua quando viu o acidente.)</li>
                                  <li>"<span class="highlight">While</span> they <span class="highlight">were studying</span>, the lights <span class="highlight">went out</span>." (Enquanto eles estavam estudando, as luzes se apagaram.)</li>
                                  <li>"I <span class="highlight">was listening</span> to music, so I <span class="highlight">didn't hear</span> the bell." (Eu estava ouvindo música, então não ouvi a campainha.)</li>
                                  <li>"What <span class="highlight">were you doing</span> when I <span class="highlight">called</span> you?" (O que você estava fazendo quando eu te liguei?)</li>
                             </ul>
                        </div>

                         <div class="topic-section">
                            <h2 class="topic-title">Adjectives & Adverbs (Adjetivos e Advérbios)</h2>
                             <p><strong>Adjetivos (Adjectives)</strong> descrevem <span class="highlight">substantivos</span> (coisas, pessoas). Ex: a <span class="highlight">beautiful</span> house (uma casa bonita).</p>
                             <p><strong>Advérbios (Adverbs)</strong> descrevem <span class="highlight">verbos</span> (como a ação é feita), adjetivos ou outros advérbios. Ex: "She sings <span class="highlight">beautifully</span>." (Ela canta lindamente).</p>
                              <h3 class="sub-topic-title">Como transformar Adjetivos em Advérbios</h3>
                             <ul>
                                 <li><strong>Regra Geral:</strong> Adicione <span class="highlight">-ly</span> ao adjetivo.
                                     <ul>
                                         <li>slow -> <span class="highlight">slowly</span> (lentamente)</li>
                                         <li>quick -> <span class="highlight">quickly</span> (rapidamente)</li>
                                         <li>sad -> <span class="highlight">sadly</span> (tristemente)</li>
                                         <li>actual -> <span class="highlight">actually</span> (na verdade)</li>
                                         <li>absolute -> <span class="highlight">absolutely</span> (absolutamente)</li>
                                         <li>fortunate -> <span class="highlight">fortunately</span> (felizmente)</li>
                                     </ul>
                                 </li>
                                 <li><strong>Adjetivos terminados em -y:</strong> Troque o 'y' por 'i' e adicione -ly.
                                      <ul>
                                         <li>easy -> <span class="highlight">easily</span> (facilmente)</li>
                                         <li>happy -> <span class="highlight">happily</span> (felizmente)</li>
                                      </ul>
                                 </li>
                                 <li><strong>Advérbios Irregulares:</strong> Alguns não seguem a regra.
                                      <ul>
                                         <li>good (bom) -> <span class="highlight">well</span> (bem)</li>
                                         <li>fast (rápido) -> <span class="highlight">fast</span> (rapidamente)</li>
                                         <li>hard (duro/difícil) -> <span class="highlight">hard</span> (duramente)</li>
                                      </ul>
                                 </li>
                             </ul>
                        </div>

                        <div class="topic-section">
                            <h2 class="topic-title">Historic Periods & Vocabulary (Períodos Históricos & Vocabulário)</h2>
                            <h3 class="sub-topic-title">Historic Periods (Períodos Históricos)</h3>
                            <p>Conhecer estes períodos é importante para a interpretação de textos.</p>
                            <ul>
                                <li><strong>Age of Discovery (Era dos Descobrimentos):</strong> Período entre os séculos XV e XVII em que exploradores europeus, como Colombo e Cabral, navegaram pelo mundo, descobrindo novas rotas e continentes.</li>
                                <li><strong>Renaissance (Renascimento):</strong> Movimento cultural, artístico e científico na Europa (séculos XIV a XVI), que resgatou os valores da Antiguidade Clássica (Grécia e Roma) e valorizou a razão e o ser humano. Leonardo da Vinci e Michelangelo são grandes nomes.</li>
                                <li><strong>Reformation (Reforma Protestante):</strong> Movimento religioso do século XVI, iniciado por Martinho Lutero, que criticou a Igreja Católica e deu origem a novas igrejas cristãs (Protestantes).</li>
                                <li><strong>Enlightenment (Iluminismo):</strong> Movimento intelectual do século XVIII que defendia a razão, a ciência, a liberdade e os direitos individuais contra o absolutismo dos reis.</li>
                                <li><strong>Industrial Revolution (Revolução Industrial):</strong> Processo de grandes mudanças tecnológicas e sociais, iniciado na Inglaterra no século XVIII, com a invenção de máquinas a vapor e a criação das fábricas.</li>
                            </ul>
                             <h3 class="sub-topic-title">Key Vocabulary (Vocabulário-Chave)</h3>
                             <ul>
                                 <li><strong>Weird:</strong> Estranho, esquisito.</li>
                                 <li><strong>Threatened:</strong> Ameaçado.</li>
                                 <li><strong>Habitat loss:</strong> Perda de habitat (lugar onde o animal vive).</li>
                                 <li><strong>Poaching:</strong> Caça ilegal.</li>
                                 <li><strong>Trafficking:</strong> Tráfico (comércio ilegal).</li>
                                 <li><strong>Regenerate:</strong> Regenerar, reconstruir partes do corpo.</li>
                             </ul>
                        </div>
                        
                    </div>
                </section>

                <section id="practice-section" class="hidden">
                     <div class="mb-4 flex justify-end">
                        <button id="order-toggle-btn" class="btn-ghost text-xs">Ordem Crescente</button>
                    </div>
                    <div id="question-buttons" class="mb-4"></div>
                    <div id="quiz-container">
                    </div>
                </section>
            </div>
        </main>
    </div>

    <script>
    document.addEventListener('DOMContentLoaded', () => {
        const root = document.documentElement;
        const themeToggle = document.getElementById('theme-toggle');
        const btnLearn = document.getElementById('btn-learn');
        const btnPractice = document.getElementById('btn-practice');
        const learnSection = document.getElementById('learn-section');
        const practiceSection = document.getElementById('practice-section');
        const questionButtons = document.getElementById('question-buttons');
        const quizContainer = document.getElementById('quiz-container');
        const orderToggleBtn = document.getElementById('order-toggle-btn');

        if(!btnLearn || !btnPractice || !learnSection || !practiceSection || !questionButtons || !quizContainer || !orderToggleBtn){
            console.error('Elementos DOM não encontrados.');
            return;
        }

        (function(){
            const t = localStorage.getItem('cmf-english-7ano-theme') || 'dark';
            if(t === 'light') root.classList.add('theme-light');
            themeToggle.addEventListener('click', () => {
                root.classList.toggle('theme-light');
                localStorage.setItem('cmf-english-7ano-theme', root.classList.contains('theme-light') ? 'light' : 'dark');
            });
        })();
        
        const quizData = [
            { topic: 'Ordinal Numbers & Centuries', difficulty: 'Fácil', q: '1) The year 1890 belongs to which century?', q_pt: '1) O ano de 1890 pertence a qual século?', options: [{text: 'The 18th century', text_pt: 'O século 18'}, {text: 'The 19th century', text_pt: 'O século 19'}, {text: 'The 20th century', text_pt: 'O século 20'}, {text: 'The 90th century', text_pt: 'O século 90'}], answer: 'The 19th century', explanation: 'Para o ano 1890, pegamos os dois primeiros dígitos (18) e somamos 1, resultando em 19. Em inglês, 19º é "nineteenth".'},
            { topic: 'Ordinal Numbers & Centuries', difficulty: 'Fácil', q: '2) How do you write "23" as an ordinal number?', q_pt: '2) Como você escreve "23" como um número ordinal?', options: [{text: 'Twenty-three', text_pt: 'Vinte e três'}, {text: 'Twenty-thirth', text_pt: 'Vinte-trintavo'}, {text: 'Twenty-third', text_pt: 'Vigésimo terceiro'}, {text: 'Twenty-threed', text_pt: 'Vinte-tresavo'}], answer: 'Twenty-third', explanation: 'Em números compostos, apenas o último dígito vira ordinal. A forma ordinal de "three" é "third".'},
            { topic: 'Ordinal Numbers & Centuries', difficulty: 'Médio', q: '3) The year 401 is in the:', q_pt: '3) O ano 401 está no:', options: [{text: '4th century', text_pt: 'século 4'}, {text: '40th century', text_pt: 'século 40'}, {text: '1st century', text_pt: 'século 1'}, {text: '5th century', text_pt: 'século 5'}], answer: '5th century', explanation: 'Para anos com 3 dígitos, pegamos o primeiro (4) e somamos 1, resultando em 5. Em inglês, 5º é "fifth".'},
            { topic: 'Ordinal Numbers & Centuries', difficulty: 'Fácil', q: '4) Which ordinal number is written correctly?', q_pt: '4) Qual número ordinal está escrito corretamente?', options: [{text: 'Fiveth', text_pt: 'Cincavo'}, {text: 'Nineth', text_pt: 'Nono'}, {text: 'Twelveth', text_pt: 'Dozeavo'}, {text: 'Eighth', text_pt: 'Oitavo'}], answer: 'Eighth', explanation: 'As formas corretas são "fifth", "ninth" e "twelfth". "Eighth" está correto.'},
            { topic: 'Ordinal Numbers & Centuries', difficulty: 'Médio', q: '5) The year 1999 is part of the:', q_pt: '5) O ano 1999 faz parte do:', options: [{text: '19th century', text_pt: 'século 19'}, {text: '20th century', text_pt: 'século 20'}, {text: '21st century', text_pt: 'século 21'}, {text: '99th century', text_pt: 'século 99'}], answer: '20th century', explanation: 'Pegamos os dois primeiros dígitos (19) e somamos 1, resultando em 20. Em inglês, 20º é "twentieth".'},
            { topic: 'Ordinal Numbers & Centuries', difficulty: 'Fácil', q: '6) How do you write the number "2" in its ordinal form?', q_pt: '6) Como você escreve o número "2" em sua forma ordinal?', options: [{text: 'Two', text_pt: 'Dois'}, {text: 'Twoth', text_pt: 'Doisavo'}, {text: 'Second', text_pt: 'Segundo'}, {text: 'Twind', text_pt: 'Duplo'}], answer: 'Second', explanation: 'O número 2 é uma das exceções principais, sua forma ordinal é "second".'},
            
            { topic: 'Simple Past', difficulty: 'Fácil', q: '7) What is the Simple Past of the verb "to begin"?', q_pt: '7) Qual é o Passado Simples do verbo "to begin"?', options: [{text: 'begun', text_pt: 'começado'}, {text: 'began', text_pt: 'começou'}, {text: 'beginned', text_pt: 'começado (forma incorreta)'}, {text: 'begind', text_pt: '(não existe)'}], answer: 'began', explanation: '"To begin" (começar) é um verbo irregular. Sua forma no passado simples é "began".'},
            { topic: 'Simple Past', difficulty: 'Médio', q: '8) Choose the correct sentence in the Simple Past:', q_pt: '8) Escolha a frase correta no Passado Simples:', options: [{text: 'She did not went to school yesterday.', text_pt: 'Ela não foi para a escola ontem.'}, {text: 'She not went to school yesterday.', text_pt: 'Ela não foi para a escola ontem.'}, {text: 'She did not go to school yesterday.', text_pt: 'Ela não foi para a escola ontem.'}, {text: 'She didn\'t went to school yesterday.', text_pt: 'Ela não foi para a escola ontem.'}], answer: 'She did not go to school yesterday.', explanation: 'Na forma negativa do Simple Past, usamos o auxiliar "did not" (ou "didn\'t") e o verbo principal volta para sua forma base (infinitivo sem "to").'},
            { topic: 'Simple Past', difficulty: 'Médio', q: '9) The Vikings often ______ coastal towns.', q_pt: '9) Os Vikings frequentemente ______ cidades costeiras.', options: [{text: 'raid', text_pt: 'saqueiam'}, {text: 'raids', text_pt: 'saqueia'}, {text: 'raided', text_pt: 'saquearam'}, {text: 'was raiding', text_pt: 'estava saqueando'}], answer: 'raided', explanation: 'A frase descreve ações passadas e concluídas. "Raid" é um verbo regular, então adicionamos "-ed".'},
            { topic: 'Simple Past', difficulty: 'Fácil', q: '10) What is the Simple Past of "see"?', q_pt: '10) Qual é o Passado Simples de "see"?', options: [{text: 'seed', text_pt: '(semente)'}, {text: 'saw', text_pt: 'viu'}, {text: 'seen', text_pt: 'visto'}, {text: 'sawed', text_pt: 'serrado'}], answer: 'saw', explanation: '"See" (ver) é um verbo irregular. Seu passado simples é "saw".'},

            { topic: 'Past Continuous', difficulty: 'Fácil', q: '11) Which sentence is in the Past Continuous?', q_pt: '11) Qual frase está no Passado Contínuo?', options: [{text: 'I play videogames.', text_pt: 'Eu jogo videogames.'}, {text: 'I was playing videogames.', text_pt: 'Eu estava jogando videogames.'}, {text: 'I were playing videogames.', text_pt: 'Eu estava jogando videogames.'}, {text: 'I played videogames.', text_pt: 'Eu joguei videogames.'}], answer: 'I was playing videogames.', explanation: 'A estrutura do Past Continuous é "was/were + verbo com -ing". Para "I", usamos "was".'},
            { topic: 'Past Continuous', difficulty: 'Médio', q: '12) "They ________ for the bus when it started to rain."', q_pt: '12) "Eles ________ pelo ônibus quando começou a chover."', options: [{text: 'waited', text_pt: 'esperaram'}, {text: 'wait', text_pt: 'esperam'}, {text: 'were waiting', text_pt: 'estavam esperando'}, {text: 'was waiting', text_pt: 'estava esperando'}], answer: 'were waiting', explanation: 'A frase descreve uma ação em progresso ("estavam esperando") que foi interrompida por outra ("começou a chover"). Para "They", usamos "were".'},
            
            { topic: 'Simple Past vs. Past Continuous', difficulty: 'Difícil', q: '13) Complete: "While I ________ my homework, my brother ________ to music."', q_pt: '13) Complete: "Enquanto eu ________ minha tarefa, meu irmão ________ música."', options: [{text: 'was doing / was listening', text_pt: 'estava fazendo / estava ouvindo'}, {text: 'did / listened', text_pt: 'fiz / ouviu'}, {text: 'was doing / listened', text_pt: 'estava fazendo / ouviu'}, {text: 'did / was listening', text_pt: 'fiz / estava ouvindo'}], answer: 'was doing / was listening', explanation: '"While" (enquanto) é usado para descrever duas ações longas que estavam acontecendo ao mesmo tempo no passado.'},
            { topic: 'Simple Past vs. Past Continuous', difficulty: 'Difícil', q: '14) "She ________ a book when her friend ________."', q_pt: '14) "Ela ________ um livro quando sua amiga ________."', options: [{text: 'read / was arriving', text_pt: 'leu / estava chegando'}, {text: 'was reading / arrived', text_pt: 'estava lendo / chegou'}, {text: 'readed / arrived', text_pt: 'leu (forma incorreta) / chegou'}, {text: 'was reading / was arriving', text_pt: 'estava lendo / estava chegando'}], answer: 'was reading / arrived', explanation: 'A ação longa ("estava lendo") foi interrompida pela ação curta ("chegou"). Usamos Past Continuous para a longa e Simple Past para a curta.'},
            { topic: 'Simple Past vs. Past Continuous', difficulty: 'Médio', q: '15) "What ________ when the accident ________?"', q_pt: '15) "O que ________ quando o acidente ________?"', options: [{text: 'were you doing / happened', text_pt: 'você estava fazendo / aconteceu'}, {text: 'did you do / was happening', text_pt: 'você fez / estava acontecendo'}, {text: 'you were doing / happened', text_pt: 'você estava fazendo / aconteceu'}, {text: 'did you do / happened', text_pt: 'você fez / aconteceu'}], answer: 'were you doing / happened', explanation: 'A pergunta é sobre o que estava em progresso (Past Continuous) no momento em que o acidente (ação curta, Simple Past) ocorreu.'},

            { topic: 'Adjectives & Adverbs', difficulty: 'Fácil', q: '16) How do you transform the adjective "slow" into an adverb?', q_pt: '16) Como você transforma o adjetivo "slow" em um advérbio?', options: [{text: 'Slowly', text_pt: 'Lentamente'}, {text: 'Slower', text_pt: 'Mais lento'}, {text: 'Slowful', text_pt: '(não existe)'}, {text: 'Slowy', text_pt: '(não existe)'}], answer: 'Slowly', explanation: 'A regra geral para formar advérbios de modo é adicionar o sufixo "-ly" ao adjetivo.'},
            { topic: 'Adjectives & Adverbs', difficulty: 'Médio', q: '17) In the sentence "He drives ________", which word fits best?', q_pt: '17) Na frase "Ele dirige ________", qual palavra se encaixa melhor?', options: [{text: 'careful', text_pt: 'cuidadoso'}, {text: 'carefully', text_pt: 'cuidadosamente'}, {text: 'careless', text_pt: 'descuidado'}, {text: 'caring', text_pt: 'carinhoso'}], answer: 'carefully', explanation: 'Precisamos de um advérbio para modificar o verbo "drives" (dirige). "Carefully" (cuidadosamente) descreve como ele dirige.'},
            { topic: 'Adjectives & Adverbs', difficulty: 'Médio', q: '18) The adverb for "good" is:', q_pt: '18) O advérbio para "good" é:', options: [{text: 'goodly', text_pt: '(não existe)'}, {text: 'goody', text_pt: '(guloseima)'}, {text: 'well', text_pt: 'bem'}, {text: 'better', text_pt: 'melhor'}], answer: 'well', explanation: '"Good" (bom) é um adjetivo irregular. Seu advérbio correspondente é "well" (bem).'},
            { topic: 'Adjectives & Adverbs', difficulty: 'Médio', q: '19) Which adverb corresponds to the adjective "absolute"?', q_pt: '19) Qual advérbio corresponde ao adjetivo "absolute"?', options: [{text: 'Absoluty', text_pt: '(não existe)'}, {text: 'Absoluteness', text_pt: '(substantivo)'}, {text: 'Absolutely', text_pt: 'Absolutamente'}, {text: 'Absolute', text_pt: '(adjetivo)'}], answer: 'Absolutely', explanation: 'Seguindo a regra geral, adicionamos "-ly" ao adjetivo "absolute" para formar o advérbio "absolutely".'},
            { topic: 'Adjectives & Adverbs', difficulty: 'Difícil', q: '20) The word "hard" can be an adjective and an adverb. Which sentence uses "hard" as an adverb?', q_pt: '20) A palavra "hard" pode ser um adjetivo e um advérbio. Qual frase usa "hard" como advérbio?', options: [{text: 'This is a hard rock.', text_pt: 'Esta é uma pedra dura.'}, {text: 'She works hard every day.', text_pt: 'Ela trabalha duro todos os dias.'}, {text: 'The test was very hard.', text_pt: 'A prova foi muito difícil.'}, {text: 'He has a hard life.', text_pt: 'Ele tem uma vida dura.'}], answer: 'She works hard every day.', explanation: 'Nesta frase, "hard" modifica o verbo "works", indicando o modo como ela trabalha, portanto é um advérbio.'},

            { topic: 'Vocabulary', difficulty: 'Médio', q: '21) The movement that valued reason and science in the 18th century was the:', q_pt: '21) O movimento que valorizou a razão e a ciência no século XVIII foi o:', options: [{text: 'Renaissance', text_pt: 'Renascimento'}, {text: 'Reformation', text_pt: 'Reforma'}, {text: 'Enlightenment', text_pt: 'Iluminismo'}, {text: 'Industrial Revolution', text_pt: 'Revolução Industrial'}], answer: 'Enlightenment', explanation: 'O Iluminismo (Enlightenment) foi um movimento intelectual que defendia a razão e a liberdade.'},
            { topic: 'Vocabulary', difficulty: 'Fácil', q: '22) What is the meaning of "poaching"?', q_pt: '22) Qual o significado de "poaching"?', options: [{text: 'Legal fishing', text_pt: 'Pesca legal'}, {text: 'Illegal hunting', text_pt: 'Caça ilegal'}, {text: 'Habitat creation', text_pt: 'Criação de habitat'}, {text: 'Animal protection', text_pt: 'Proteção animal'}], answer: 'Illegal hunting', explanation: '"Poaching" significa caça ilegal, uma das maiores ameaças a animais como o pangolim.'},
            { topic: 'Vocabulary', difficulty: 'Fácil', q: '23) The Amazon River Dolphin is threatened by "habitat loss". This means:', q_pt: '23) O Boto-cor-de-rosa está ameaçado pela "perda de habitat". Isso significa:', options: [{text: 'It has too many homes', text_pt: 'Ele tem casas demais'}, {text: 'Its natural home is being destroyed', text_pt: 'Seu lar natural está sendo destruído'}, {text: 'It is being hunted', text_pt: 'Ele está sendo caçado'}, {text: 'It cannot find food', text_pt: 'Ele não consegue encontrar comida'}], answer: 'Its natural home is being destroyed', explanation: '"Habitat loss" é a destruição do ambiente natural onde uma espécie vive.'},
            { topic: 'Vocabulary', difficulty: 'Médio', q: '24) A key characteristic of "Amphibians" is that they:', q_pt: '24) Uma característica chave dos "Anfíbios" é que eles:', options: [{text: 'Have scales', text_pt: 'Têm escamas'}, {text: 'Live part of their life in water and part on land', text_pt: 'Vivem parte da vida na água e parte na terra'}, {text: 'Have feathers', text_pt: 'Têm penas'}, {text: 'Feed their babies with milk', text_pt: 'Alimentam seus filhotes com leite'}], answer: 'Live part of their life in water and part on land', explanation: 'Anfíbios, como sapos, têm uma fase larval aquática e uma fase adulta terrestre.'},
            { topic: 'Vocabulary', difficulty: 'Fácil', q: '25) The period of great technological changes with the invention of steam machines is called:', q_pt: '25) O período de grandes mudanças tecnológicas com a invenção das máquinas a vapor é chamado de:', options: [{text: 'Renaissance', text_pt: 'Renascimento'}, {text: 'Industrial Revolution', text_pt: 'Revolução Industrial'}, {text: 'Age of Discovery', text_pt: 'Era dos Descobrimentos'}, {text: 'Reformation', text_pt: 'Reforma'}], answer: 'Industrial Revolution', explanation: 'A Revolução Industrial marcou a transição da produção manual para a industrial.'},
            { topic: 'Vocabulary', difficulty: 'Médio', q: '26) The ability of the Axolotl to regrow parts of its body is called:', q_pt: '26) A habilidade do Axolote de recriar partes do seu corpo é chamada de:', options: [{text: 'Poaching', text_pt: 'Caça ilegal'}, {text: 'Trafficking', text_pt: 'Tráfico'}, {text: 'Regeneration', text_pt: 'Regeneração'}, {text: 'Reformation', text_pt: 'Reforma'}], answer: 'Regeneration', explanation: '"Regeneration" (Regeneração) é a capacidade de um organismo de reconstruir partes perdidas ou danificadas.'},
            { topic: 'Vocabulary', difficulty: 'Fácil', q: '27) Which group of vertebrates typically has feathers?', q_pt: '27) Qual grupo de vertebrados tipicamente tem penas?', options: [{text: 'Fish', text_pt: 'Peixes'}, {text: 'Reptiles', text_pt: 'Répteis'}, {text: 'Birds', text_pt: 'Aves'}, {text: 'Mammals', text_pt: 'Mamíferos'}], answer: 'Birds', explanation: 'Feathers (penas) are an exclusive characteristic of birds (aves).'},
            { topic: 'Vocabulary', difficulty: 'Médio', q: '28) The "Renaissance" was a cultural movement inspired by:', q_pt: '28) O "Renascimento" foi um movimento cultural inspirado por:', options: [{text: 'The Middle Ages', text_pt: 'A Idade Média'}, {text: 'Ancient Greece and Rome', text_pt: 'A Grécia e Roma Antigas'}, {text: 'The Industrial Revolution', text_pt: 'A Revolução Industrial'}, {text: 'Ancient Egypt', text_pt: 'O Egito Antigo'}], answer: 'Ancient Greece and Rome', explanation: 'O Renascimento resgatou os valores artísticos, filosóficos e científicos da Antiguidade Clássica (Grécia e Roma Antigas).'},
            { topic: 'Vocabulary', difficulty: 'Fácil', q: '29) What is a "Tapir"?', q_pt: '29) O que é uma "Anta"?', options: [{text: 'A type of fish', text_pt: 'Um tipo de peixe'}, {text: 'A pig-hippo hybrid', text_pt: 'Um híbrido de porco e hipopótamo'}, {text: 'A large mammal related to horses and rhinos', text_pt: 'Um grande mamífero parente de cavalos e rinocerontes'}, {text: 'A species of bird', text_pt: 'Uma espécie de pássaro'}], answer: 'A large mammal related to horses and rhinos', explanation: 'O Tapir (Anta) é um mamífero que, apesar da aparência, é parente dos cavalos e rinocerontes.'},
            { topic: 'Vocabulary', difficulty: 'Médio', q: '30) The "Hundred Years\' War" was fought between which two countries?', q_pt: '30) A "Guerra dos Cem Anos" foi travada entre quais dois países?', options: [{text: 'Spain and Portugal', text_pt: 'Espanha e Portugal'}, {text: 'England and France', text_pt: 'Inglaterra e França'}, {text: 'Rome and Carthage', text_pt: 'Roma e Cartago'}, {text: 'The Vikings and the Turks', text_pt: 'Os Vikings e os Turcos'}], answer: 'England and France', explanation: 'Foi uma longa série de conflitos entre a Inglaterra e a França durante a Baixa Idade Média.'},

            // Revisão Geral
            { topic: 'Revisão Geral', difficulty: 'Difícil', q: '31) "Copernicus ________ the stars when he ________ his heliocentric theory."', q_pt: '31) "Copérnico ________ as estrelas quando ele ________ sua teoria heliocêntrica."', options: [{text: 'observed / formulated', text_pt: 'observou / formulou'}, {text: 'was observing / formulated', text_pt: 'estava observando / formulou'}, {text: 'observed / was formulating', text_pt: 'observou / estava formulando'}, {text: 'was observing / was formulating', text_pt: 'estava observando / estava formulando'}], answer: 'was observing / formulated', explanation: 'A ação de observar era longa e contínua (Past Continuous) e, durante esse processo, ele teve a ideia e a formulou (ação curta, Simple Past).'},
            { topic: 'Revisão Geral', difficulty: 'Fácil', q: '32) The year 888 belongs to the:', q_pt: '32) O ano 888 pertence ao:', options: [{text: '8th century', text_pt: 'século 8'}, {text: '88th century', text_pt: 'século 88'}, {text: '9th century', text_pt: 'século 9'}, {text: '1st century', text_pt: 'século 1'}], answer: '9th century', explanation: 'Para anos com 3 dígitos, pegamos o primeiro (8) e somamos 1, resultando em 9 (ninth).'},
            { topic: 'Revisão Geral', difficulty: 'Médio', q: '33) How do you say "décimo segundo" in English?', q_pt: '33) Como se diz "décimo segundo" em inglês?', options: [{text: 'Ten-second', text_pt: 'Dez-segundo'}, {text: 'Twelveth', text_pt: 'Dozeavo'}, {text: 'Twelfth', text_pt: 'Décimo segundo'}, {text: 'Twelve', text_pt: 'Doze'}], answer: 'Twelfth', explanation: '"Twelve" é uma exceção. Sua forma ordinal é "twelfth".'},
            { topic: 'Revisão Geral', difficulty: 'Médio', q: '34) "While Leonardo da Vinci ________ flying machines, he also ________ birds in detail."', q_pt: '34) "Enquanto Leonardo da Vinci ________ máquinas voadoras, ele também ________ pássaros em detalhe."', options: [{text: 'was sketching / was studying', text_pt: 'estava esboçando / estava estudando'}, {text: 'sketched / studied', text_pt: 'esboçou / estudou'}, {text: 'was sketching / studied', text_pt: 'estava esboçando / estudou'}, {text: 'sketched / was studying', text_pt: 'esboçou / estava estudando'}], answer: 'was sketching / was studying', explanation: 'As duas ações ("esboçar" e "estudar") eram longas e aconteciam simultaneamente no passado.'},
            { topic: 'Revisão Geral', difficulty: 'Fácil', q: '35) What is the adverb for "happy"?', q_pt: '35) Qual é o advérbio para "happy"?', options: [{text: 'Happyly', text_pt: '(não existe)'}, {text: 'Happily', text_pt: 'Felizmente'}, {text: 'Happiness', text_pt: 'Felicidade (substantivo)'}, {text: 'Happier', text_pt: 'Mais feliz (comparativo)'}], answer: 'Happily', explanation: 'Para adjetivos terminados em "y", trocamos o "y" por "i" e adicionamos "-ly".'},
            { topic: 'Revisão Geral', difficulty: 'Difícil', q: '36) "Martin Luther ________ when he ________ to challenge the Catholic Church."', q_pt: '36) "Martinho Lutero ________ quando ele ________ desafiar a Igreja Católica."', options: [{text: 'preached / decided', text_pt: 'pregou / decidiu'}, {text: 'was preaching / decided', text_pt: 'estava pregando / decidiu'}, {text: 'preached / was deciding', text_pt: 'pregou / estava decidindo'}, {text: 'was preaching / was deciding', text_pt: 'estava pregando / estava decidindo'}], answer: 'was preaching / decided', explanation: 'A ação de pregar era contínua (Past Continuous), e em algum momento durante esse período, ele tomou a decisão (ação curta, Simple Past).'},
            { topic: 'Revisão Geral', difficulty: 'Fácil', q: '37) The year 2000 is the last year of the:', q_pt: '37) O ano 2000 é o último ano do:', options: [{text: '21st century', text_pt: 'século 21'}, {text: '19th century', text_pt: 'século 19'}, {text: '20th century', text_pt: 'século 20'}, {text: '1st century', text_pt: 'século 1'}], answer: '20th century', explanation: 'Anos terminados em "00" pertencem ao século indicado pelos primeiros dígitos. O século XXI começa em 2001.'},
            { topic: 'Revisão Geral', difficulty: 'Médio', q: '38) The word "actually" means:', q_pt: '38) A palavra "actually" significa:', options: [{text: 'Currently', text_pt: 'Atualmente'}, {text: 'In fact / really', text_pt: 'Na verdade / realmente'}, {text: 'An action', text_pt: 'Uma ação'}, {text: 'Fortunately', text_pt: 'Felizmente'}], answer: 'In fact / really', explanation: '"Actually" é um falso cognato. Parece "atualmente", mas significa "na verdade" ou "realmente".'},
            { topic: 'Revisão Geral', difficulty: 'Médio', q: '39) "William Shakespeare ________ at the Globe Theatre when a fire ________ out."', q_pt: '39) "William Shakespeare ________ no Globe Theatre quando um incêndio ________."', options: [{text: 'was performing / broke', text_pt: 'estava atuando / começou'}, {text: 'performed / was breaking', text_pt: 'atuou / estava começando'}, {text: 'performed / broke', text_pt: 'atuou / começou'}, {text: 'was performing / was breaking', text_pt: 'estava atuando / estava começando'}], answer: 'was performing / broke', explanation: 'A ação de atuar estava em progresso (Past Continuous) quando foi interrompida pelo início do incêndio (Simple Past).'},
            { topic: 'Revisão Geral', difficulty: 'Difícil', q: '40) Which sentence is grammatically correct?', q_pt: '40) Qual frase está gramaticalmente correta?', options: [{text: 'He spokely very fastly.', text_pt: '(Incorreta)'}, {text: 'He drove slow and careful.', text_pt: '(Incorreta)'}, {text: 'She sang good at the show.', text_pt: '(Incorreta)'}, {text: 'The team played well and won easily.', text_pt: '(Correta)'}], answer: 'The team played well and won easily.', explanation: 'Usa os advérbios corretos: "well" (advérbio irregular de "good") e "easily" (formado a partir de "easy").'}
        ];

        let questionOrder = quizData.map((_,i)=>i);
        let currentIndex = 0;
        let questionStatus = Array(quizData.length).fill(null);
        let quizStarted = false;
        let isRandomOrder = false; 

        // DOM Elements for the quiz
        const questionInfoContainer = document.createElement('div');
        questionInfoContainer.className = 'flex justify-between items-center mb-2';
        const questionTopic = document.createElement('p');
        questionTopic.className='text-sm font-semibold text-[var(--accent)]';
        const questionDifficulty = document.createElement('span');
        const questionText = document.createElement('div');
        const optionsContainer = document.createElement('div');
        optionsContainer.className='mt-4 grid gap-3';
        const feedbackContainer = document.createElement('div');
        const nextBtn = document.createElement('button');
        nextBtn.className='btn-primary mt-4 hidden';
        nextBtn.textContent='Próxima';
        const redoBtn = document.createElement('button');
        redoBtn.className='btn-ghost mt-4 ml-3 hidden';
        redoBtn.textContent='Refazer';

        quizContainer.appendChild(questionInfoContainer);
        quizContainer.appendChild(questionText);
        quizContainer.appendChild(optionsContainer);
        quizContainer.appendChild(feedbackContainer);
        quizContainer.appendChild(nextBtn);
        quizContainer.appendChild(redoBtn);
        
        orderToggleBtn.addEventListener('click', () => {
            isRandomOrder = !isRandomOrder; 
            orderToggleBtn.textContent = isRandomOrder ? 'Ordem Aleatória' : 'Ordem Crescente';
            startQuiz();
        });

        function switchView(view){
            if(view==='learn'){
                practiceSection.classList.add('hidden');
                learnSection.classList.remove('hidden');
                btnLearn.classList.replace('btn-ghost', 'btn-primary');
                btnPractice.classList.replace('btn-primary', 'btn-ghost');
            } else {
                learnSection.classList.add('hidden');
                practiceSection.classList.remove('hidden');
                btnPractice.classList.replace('btn-ghost', 'btn-primary');
                btnLearn.classList.replace('btn-primary', 'btn-ghost');
                if (!quizStarted) {
                    startQuiz();
                    quizStarted = true;
                }
            }
        }

        btnLearn.addEventListener('click', () => switchView('learn'));
        btnPractice.addEventListener('click', () => switchView('practice'));

        function renderQuestionButtons(){
            questionButtons.innerHTML='';
            quizData.forEach((_,originalIndex)=>{
                const b = document.createElement('button');
                b.textContent = (originalIndex + 1);
                b.setAttribute('data-original-index', String(originalIndex));
                b.title = `Ir para a questão ${originalIndex+1}`;
                b.onclick = ()=>{
                    const pos = questionOrder.indexOf(originalIndex);
                    if(pos >= 0){ currentIndex = pos; showQuestion(); }
                };
                if(questionStatus[originalIndex]==='correct') b.classList.add('correct-status');
                if(questionStatus[originalIndex]==='wrong') b.classList.add('wrong-status');
                
                if (quizStarted && currentIndex < quizData.length) {
                    const currentQuestionOriginalIndex = questionOrder[currentIndex];
                    if(originalIndex === currentQuestionOriginalIndex) {
                        b.classList.add('current-question');
                    }
                }
                
                questionButtons.appendChild(b);
            });
        }
        
        function startQuiz(){
            if (isRandomOrder) {
                shuffleArray(questionOrder);
            } else {
                questionOrder = quizData.map((_, i) => i);
            }
            currentIndex = 0;
            questionStatus.fill(null);
            showQuestion();
        }

        function showQuestion(){
            const finalResultsDiv = document.getElementById('final-results');
            if (finalResultsDiv) finalResultsDiv.remove();
            quizContainer.style.display = 'block';

            if (currentIndex >= quizData.length) {
                showFinalResults();
                return;
            }
        
            const qIdx = questionOrder[currentIndex];
            const qObj = quizData[qIdx];
            
            questionInfoContainer.classList.remove('hidden');
            questionTopic.textContent = qObj.topic;
            questionDifficulty.textContent = qObj.difficulty;
            questionDifficulty.className = `difficulty-badge difficulty-${qObj.difficulty.toLowerCase()}`;
            
            questionText.innerHTML = `
                <p class="text-xl mt-2">${qIdx + 1}) ${qObj.q.replace(/^[\s\d\)\(\.\:\-–—_]+/,'').trim()}</p>
                <p class="text-sm text-slate-400 mt-1">${qObj.q_pt.replace(/^[\s\d\)\(\.\:\-–—_]+/,'').trim()}</p>
            `;
            
            optionsContainer.innerHTML='';
            feedbackContainer.innerHTML='';
            redoBtn.classList.add('hidden');
            nextBtn.classList.add('hidden'); 
            
            qObj.options.forEach(opt =>{
                const b = document.createElement('button');
                b.className='option-btn';
                b.innerHTML = `${opt.text}<br><span class="text-xs text-slate-400">${opt.text_pt}</span>`;
                b.onclick = ()=> selectAnswer(b, opt.text, qObj.answer, qObj.explanation, qIdx);
                optionsContainer.appendChild(b);
            });

            renderQuestionButtons();
        }
        
        function showFinalResults() {
            const correctCount = questionStatus.filter(s => s === 'correct').length;
            const total = quizData.length;
            
            quizContainer.style.display = 'none';

            let finalResultsDiv = document.createElement('div');
            finalResultsDiv.id = 'final-results';
            finalResultsDiv.className = 'text-center';
            practiceSection.appendChild(finalResultsDiv);

            finalResultsDiv.innerHTML = `
                <h2 class="text-2xl font-bold">🎉 Fim do Quiz! 🎉</h2>
                <p class="text-lg mt-4">Você acertou ${correctCount} de ${total} questões.</p>
                <button id="restart-btn" class="btn-primary mt-6">Recomeçar Quiz</button>
            `;
            
            document.getElementById('restart-btn').onclick = () => {
                quizStarted = false;
                startQuiz(); 
                quizStarted = true;
            };
        }

        function selectAnswer(btn,optText,correct,explanation,qIdx){
            Array.from(optionsContainer.children).forEach(b=> {
                b.disabled=true;
                if(b.innerHTML.startsWith(correct)) {
                    b.classList.add('correct');
                }
            });
            nextBtn.classList.remove('hidden');

            if(optText===correct){
                btn.classList.add('celebrate');
                createConfetti();
                questionStatus[qIdx]='correct';
                feedbackContainer.className='feedback-correct mt-4';
                feedbackContainer.textContent = 'Correto! ' + (explanation || '');
            } else {
                btn.classList.add('wrong');
                questionStatus[qIdx]='wrong';
                feedbackContainer.className='feedback-wrong mt-4';
                feedbackContainer.innerHTML = `<strong>Errado.</strong> ${explanation || ''}`;
                redoBtn.classList.remove('hidden');
            }
            renderQuestionButtons();
        }

        nextBtn.addEventListener('click', ()=>{
            if(currentIndex < questionOrder.length-1){ 
                currentIndex++; 
                showQuestion(); 
            } else { 
                currentIndex++;
                showFinalResults();
            }
        });

        redoBtn.addEventListener('click', ()=>{
            const currentQuestionIndex = questionOrder[currentIndex];
            questionStatus[currentQuestionIndex] = null;
            showQuestion();
        });

        function shuffleArray(a){
            for(let i=a.length-1;i>0;i--){ const j=Math.floor(Math.random()*(i+1)); [a[i],a[j]]=[a[j],a[i]]; }
        }

        function createConfetti(){
            const colors = ['#f59e0b','#ef4444','#10b981','#3b82f6','#8b5cf6'];
            for(let i=0;i<12;i++){
                const el = document.createElement('div');
                el.className='confetti';
                el.style.left = (30 + Math.random()*40) + '%';
                el.style.top = (10 + Math.random()*10) + 'vh';
                el.style.color = colors[Math.floor(Math.random()*colors.length)];
                el.textContent = '🎉';
                el.style.transform = `rotate(${Math.random()*360}deg)`;
                el.style.animation = `confetti-fall ${1.2 + Math.random()*1}s linear forwards`;
                document.body.appendChild(el);
                setTimeout(()=> el.remove(), 2200);
            }
        }
        
        switchView('learn');
    });
    </script>
</body>
</html>

