<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Prova CMF ‚Äì 1¬∫ Ano (Portugu√™s)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        :root{
            --bg:#071023; --card:#0b1624; --accent:#3b82f6; --muted:#97a6bf; --text:#e6eef8; --success:#34d399; --danger:#ef4444; --border:rgba(255,255,255,0.04); --muted-2: rgba(230,238,248,0.85);
        }
        html,body{height:100%;margin:0;font-family:Inter, system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial; background:var(--bg); color:var(--text);}
        .container{max-width:980px;margin:28px auto;padding:18px}
        .page-header{ padding:1.25rem; border-radius:12px; background: linear-gradient(180deg, rgba(59,130,246,0.06), transparent); box-shadow: 0 8px 24px rgba(2,6,23,0.6); }
        .card{ background: var(--card); color: var(--text); border: 1px solid var(--border); border-radius: 12px; box-shadow: 0 6px 20px rgba(2,6,23,0.6); padding:18px }
        .btn-primary{ background: linear-gradient(90deg,var(--accent), #3b82f6); color: #061226; padding: .5rem 1.25rem; border-radius: 10px; border: none; box-shadow: 0 6px 18px rgba(59,130,246,0.12); cursor: pointer; }
        .btn-ghost{ background: transparent; color: var(--muted-2); padding: .45rem .9rem; border-radius: 10px; border: 1px solid var(--border); cursor:pointer; }
        .option-btn{ display:block; width:100%; text-align:left; padding:.75rem 1rem; border-radius:10px; background: rgba(255,255,255,0.02); border:1px solid var(--border); color:var(--muted-2); cursor:pointer; transition: transform 150ms ease, background 150ms ease; }
        .option-btn:hover:not(:disabled){ background: rgba(255,255,255,0.035); transform: translateY(-1px); }
        .option-btn.correct{ background: var(--success) !important; color: #062e1f !important; border-color: rgba(4,120,87,0.18) !important; }
        .option-btn.wrong{ background: var(--danger) !important; color: #fff !important; border-color: rgba(185,28,28,0.18) !important; }
        .option-btn:disabled { cursor: not-allowed; }
        #question-buttons{ display:flex; flex-wrap:wrap; gap:8px; }
        #question-buttons button{ background: transparent; color: var(--muted-2); border:1px solid var(--border); padding:.45rem .6rem; border-radius:8px; cursor:pointer; }
        #question-buttons button.current-question { background-color: rgba(59, 130, 246, 0.2); border-color: var(--accent); }
        #question-buttons button.correct-status { background-color: var(--success); color: #062e1f; border-color: transparent; }
        #question-buttons button.wrong-status { background-color: var(--danger); color: white; border-color: transparent; }
        .feedback-correct{ background: rgba(16,185,129,0.12); border:1px solid rgba(16,185,129,0.22); color: #bbf7d0; padding:12px; border-radius:8px }
        .feedback-wrong{ background: rgba(239,68,68,0.12); border:1px solid rgba(239,68,68,0.22); color: #ffdede; padding:12px; border-radius:8px }
        .celebrate{ animation: pop 480ms cubic-bezier(.2,.9,.3,1); box-shadow: 0 12px 36px rgba(96,165,250,0.18), 0 0 28px rgba(16,185,129,0.12); }
        @keyframes pop{ 0%{ transform: scale(1); } 50%{ transform: scale(1.08); } 100%{ transform: scale(1); } }
        .confetti{ position: fixed; z-index: 9999; pointer-events: none; font-size: 18px; opacity: 1; transform-origin: center; }
        @keyframes confetti-fall { 0%{ transform: translateY(-10vh) rotate(0deg); opacity:1 } 100%{ transform: translateY(100vh) rotate(540deg); opacity:0 } }
        .theme-light{ --bg: #f8fafc; --card: #ffffff; --muted: #475569; --text: #0f1724; --accent: #0284c7; --success: #047857; --danger: #b91c1c; --border: rgba(15,23,42,0.06); --muted-2: rgba(15,23,36,0.85); }
    </style>
</head>
<body class="antialiased">
    <div class="container">
        <header class="page-header">
            <div class="flex justify-between items-center">
                <div>
                    <h1 class="text-2xl font-bold">Prova CMF ‚Äî 1¬∫ Ano: Portugu√™s</h1>
                    <p class="text-sm text-slate-400">Resumo dos principais t√≥picos + 25 quest√µes para pr√°tica.</p>
                </div>
                <div>
                    <button id="theme-toggle" class="btn-ghost">Tema</button>
                </div>
            </div>
        </header>

        <main class="mt-6">
            <div class="card">
                <nav class="mb-4">
                    <button id="btn-learn" class="btn-primary">Aprender</button>
                    <button id="btn-practice" class="btn-ghost ml-2">Praticar</button>
                </nav>

                <section id="learn-section">
                    <div class="space-y-6">
                        <div>
                            <h2 class="text-2xl font-semibold text-[var(--accent)]">I. Compreens√£o Textual</h2>
                            <p class="mt-2 text-sm text-slate-300">Habilidade de decodificar e interpretar textos, extraindo informa√ß√µes e compreendendo a inten√ß√£o do autor.</p>
                            
                            <h3 class="text-lg font-semibold mt-4">T√≥picos Essenciais:</h3>
                            <ul class="mt-2 text-sm list-disc list-inside space-y-2">
                                <li><strong>Textos Multimodais:</strong> Combinam linguagem verbal (palavras) e n√£o verbal (imagens, gr√°ficos, sons). O sentido √© constru√≠do pela intera√ß√£o de todos os elementos, como em tirinhas, infogr√°ficos e an√∫ncios.</li>
                                <li><strong>G√™neros e Finalidade:</strong> Cada g√™nero textual (not√≠cia, receita, poema, cr√¥nica) tem um objetivo: informar, instruir, emocionar, argumentar. Identificar essa finalidade √© o primeiro passo para a compreens√£o.</li>
                                <li><strong>Informa√ß√µes Impl√≠citas:</strong> S√£o ideias n√£o ditas diretamente no texto, mas que podem ser subentendidas a partir de pistas, do contexto e do seu conhecimento de mundo.</li>
                                <li><strong>Tese e Argumentos:</strong> Em textos argumentativos, a <strong>tese</strong> √© a ideia principal defendida pelo autor. Os <strong>argumentos</strong> s√£o as justificativas, os fatos e os racioc√≠nios usados para comprovar a tese.</li>
                                <li><strong>Ironia e Humor:</strong> A <strong>ironia</strong> consiste em dizer o contr√°rio do que se pensa, geralmente com inten√ß√£o cr√≠tica. O <strong>humor</strong> surge da quebra de expectativa, de situa√ß√µes inesperadas ou do uso amb√≠guo de palavras.</li>
                                <li><strong>Escolha Lexical:</strong> A sele√ß√£o de palavras (l√©xico) nunca √© neutra. Escolher entre "lar", "casa" e "barraco" ou entre "pol√≠tico" e "estadista" altera o sentido e revela a posi√ß√£o do autor.</li>
                            </ul>
                        </div>
                        <hr class="border-[var(--border)]">
                        <div>
                             <h2 class="text-2xl font-semibold text-[var(--accent)]">II. An√°lise e Reflex√£o Lingu√≠stica</h2>
                             <p class="mt-2 text-sm">Estudo da estrutura e do funcionamento da l√≠ngua portuguesa, aplicando conhecimentos gramaticais para entender a constru√ß√£o de sentidos no texto.</p>
                             <h3 class="text-lg font-semibold mt-4">T√≥picos Essenciais:</h3>
                             <ul class="mt-2 text-sm list-disc list-inside space-y-2">
                                <li><strong>Denota√ß√£o e Conota√ß√£o:</strong> <strong>Denota√ß√£o</strong> √© o sentido literal, do dicion√°rio (ex: "cora√ß√£o" = √≥rg√£o). <strong>Conota√ß√£o</strong> √© o sentido figurado, associado a emo√ß√µes e cultura (ex: "meu cora√ß√£o est√° em festa").</li>
                                <li><strong>Figuras de Linguagem:</strong> Recursos para tornar a linguagem mais expressiva, como a <strong>met√°fora</strong> (compara√ß√£o impl√≠cita), a <strong>compara√ß√£o</strong> (com conectivo), a <strong>meton√≠mia</strong> (troca de termos) e a <strong>hip√©rbole</strong> (exagero).</li>
                                <li><strong>Coes√£o e Coer√™ncia:</strong> A <strong>coes√£o</strong> √© a liga√ß√£o entre as partes de um texto, feita por pronomes, sin√¥nimos e conectivos (conjun√ß√µes). A <strong>coer√™ncia</strong> √© o sentido l√≥gico do texto.</li>
                                <li><strong>Classes de Palavras:</strong> As 10 classes (substantivo, verbo, adjetivo, etc.) e suas fun√ß√µes na constru√ß√£o das frases.</li>
                                <li><strong>Sintaxe (Rela√ß√µes no Per√≠odo):</strong> Estudo das ora√ß√µes <strong>coordenadas</strong> (independentes) e <strong>subordinadas</strong> (dependentes). Os conectivos (e, mas, que, quando) mostram a rela√ß√£o entre elas (adi√ß√£o, oposi√ß√£o, causa).</li>
                                <li><strong>Vozes Verbais:</strong> <strong>Voz Ativa</strong> (o sujeito pratica a a√ß√£o: "A turma leu o livro"). <strong>Voz Passiva</strong> (o sujeito sofre a a√ß√£o: "O livro foi lido pela turma").</li>
                                <li><strong>Concord√¢ncia e Reg√™ncia:</strong> A <strong>concord√¢ncia</strong> √© a harmonia entre termos (sujeito-verbo; substantivo-adjetivo). A <strong>reg√™ncia</strong> √© a rela√ß√£o de depend√™ncia, muitas vezes com preposi√ß√£o, entre um verbo/nome e seu complemento (ex: "assistir <strong>ao</strong> filme", "necessidade <strong>de</strong> ajuda").</li>
                             </ul>
                        </div>
                    </div>
                </section>

                <section id="practice-section" class="hidden">
                    <div id="question-buttons" class="mb-4"></div>
                    <div id="quiz-container">
                        </div>
                </section>
            </div>
        </main>
    </div>

    <script>
    document.addEventListener('DOMContentLoaded', () => {
        // Elements
        const root = document.documentElement;
        const themeToggle = document.getElementById('theme-toggle');
        const btnLearn = document.getElementById('btn-learn');
        const btnPractice = document.getElementById('btn-practice');
        const learnSection = document.getElementById('learn-section');
        const practiceSection = document.getElementById('practice-section');
        const questionButtons = document.getElementById('question-buttons');
        const quizContainer = document.getElementById('quiz-container');

        if(!btnLearn || !btnPractice || !learnSection || !practiceSection || !questionButtons || !quizContainer){
            console.error('Elementos DOM n√£o encontrados.');
            return;
        }

        (function(){
            const t = localStorage.getItem('cmf-port-theme') || 'dark';
            if(t === 'light') root.classList.add('theme-light');
            themeToggle.addEventListener('click', () => {
                root.classList.toggle('theme-light');
                localStorage.setItem('cmf-port-theme', root.classList.contains('theme-light') ? 'light' : 'dark');
            });
        })();
        
        const quizData = [
            // Compreens√£o Textual
            { q: '1) "Que gentileza a sua chegar duas horas atrasado para a reuni√£o!" A frase expressa:', options: ['Ironia', 'Elogio', 'D√∫vida', 'S√∫plica'], answer: 'Ironia', explanation: 'O autor diz o oposto do que realmente pensa, criticando o atraso.'},
            { q: '2) Em uma tirinha, o texto diz "Estou bem", mas o personagem aparece chorando. Para entender a mensagem, √© preciso analisar:', options: ['A rela√ß√£o entre texto e imagem (multimodalidade)', 'Apenas o texto escrito', 'Apenas a imagem', 'A classe das palavras'], answer: 'A rela√ß√£o entre texto e imagem (multimodalidade)', explanation: 'O sentido completo s√≥ √© obtido pela combina√ß√£o do verbal com o n√£o verbal.'},
            { q: '3) "Jo√£o morava num casebre no alto do morro." A palavra "casebre" tem uma conota√ß√£o de:', options: ['Pobreza, simplicidade', 'Riqueza, luxo', 'Modernidade', 'Seguran√ßa'], answer: 'Pobreza, simplicidade', explanation: 'A escolha lexical "casebre" sugere uma moradia humilde, diferente de "casa" ou "mans√£o".'},
            { q: '4) "Ele n√£o era o melhor aluno da turma, mas seu esfor√ßo era not√°vel." Do trecho, pode-se inferir que:', options: ['O esfor√ßo pode compensar a falta de talento', 'Ele era um aluno pregui√ßoso', 'A turma inteira era de g√™nios', 'Esfor√ßo n√£o leva a lugar nenhum'], answer: 'O esfor√ßo pode compensar a falta de talento', explanation: 'A frase sugere que, apesar de n√£o ser o mais brilhante, seu empenho era um grande valor. Esta √© uma informa√ß√£o impl√≠cita.'},
            { q: '5) A principal finalidade de uma receita culin√°ria √©:', options: ['Instruir', 'Narrar', 'Argumentar', 'Descrever'], answer: 'Instruir', explanation: 'Textos instrucionais, como receitas e manuais, t√™m o objetivo de guiar o leitor a realizar uma tarefa.'},
            { q: '6) Na frase "Aquele pol√≠tico √© uma raposa", a palavra "raposa" est√° em sentido:', options: ['Conotativo', 'Denotativo', 'Literal', 'T√©cnico'], answer: 'Conotativo', explanation: '"Raposa" √© usada no sentido figurado de "pessoa astuta", e n√£o no sentido literal do animal.'},
            { q: '7) Qual das alternativas cont√©m uma figura de linguagem (met√°fora)?', options: ['"A vida √© uma nuvem que voa."', '"O c√©u est√° azul."', '"Comprei um quilo de a√ß√∫car."', '"Ele chegou cedo."'], answer: '"A vida √© uma nuvem que voa."', explanation: 'H√° uma compara√ß√£o impl√≠cita entre "vida" e "nuvem", caracter√≠stica da met√°fora.'},
            { q: '8) Tese √©:', options: ['A ideia principal defendida no texto.', 'Um exemplo usado para ilustrar algo.', 'A conclus√£o do texto.', 'Uma pergunta que o texto responde.'], answer: 'A ideia principal defendida no texto.', explanation: 'Tese √© a posi√ß√£o central que o autor busca defender com argumentos.'},
            
            // An√°lise Lingu√≠stica
            { q: '9) Na frase "Os atletas treinaram muito, POR√âM n√£o venceram o campeonato", o conectivo destacado indica:', options: ['Oposi√ß√£o', 'Conclus√£o', 'Explica√ß√£o', 'Adi√ß√£o'], answer: 'Oposi√ß√£o', explanation: '"Por√©m" √© uma conjun√ß√£o adversativa, que conecta ideias contr√°rias.'},
            { q: '10) Qual a forma correta de concord√¢ncia verbal?', options: ['Faz cinco anos que n√£o o vejo.', 'Fazem cinco anos que n√£o o vejo.', 'Existe muitas pessoas na pra√ßa.', 'Houveram muitos acidentes.'], answer: 'Faz cinco anos que n√£o o vejo.', explanation: 'O verbo "fazer" indicando tempo decorrido √© impessoal e fica na 3¬™ pessoa do singular.'},
            { q: '11) "A casa foi constru√≠da pelos pedreiros." Passando para a voz ativa, temos:', options: ['Os pedreiros constru√≠ram a casa.', 'A casa se construiu.', 'Construiu-se a casa.', 'Os pedreiros eram construtores.'], answer: 'Os pedreiros constru√≠ram a casa.', explanation: 'O sujeito da passiva ("pelos pedreiros") se torna o sujeito da ativa.'},
            { q: '12) Em "Tenho necessidade ___ aprova√ß√£o", a reg√™ncia do nome "necessidade" exige a preposi√ß√£o:', options: ['de', 'a', 'com', 'em'], answer: 'de', explanation: 'Quem tem necessidade, tem necessidade DE algo. A preposi√ß√£o correta √© "de".'},
            { q: '13) Qual verbo exige a preposi√ß√£o "a" em sua reg√™ncia?', options: ['Assistir (no sentido de ver)', 'Namorar', 'Comer', 'Ajudar'], answer: 'Assistir (no sentido de ver)', explanation: 'No sentido de ver, o correto √© "assistir AO filme", "assistir √Ä pe√ßa".'},
            { q: '14) Na frase "O amor materno √© sublime", a express√£o "materno" √© um adjetivo. Qual locu√ß√£o adjetiva correspondente?', options: ['de m√£e', 'de mulher', 'de filho', 'de fam√≠lia'], answer: 'de m√£e', explanation: '"De m√£e" √© uma locu√ß√£o adjetiva que equivale ao adjetivo "materno".'},
            { q: '15) Em "Precisa-se de funcion√°rios", o sujeito da ora√ß√£o √©:', options: ['Indeterminado', 'Funcion√°rios', 'Oculto (Eu)', 'Inexistente'], answer: 'Indeterminado', explanation: 'O verbo na 3¬™ pessoa do singular + a part√≠cula "se" (√≠ndice de indetermina√ß√£o do sujeito) torna o sujeito indeterminado.'},
            { q: '16) Em "Compramos belas flores", a palavra "belas" √© classificada como:', options: ['Adjetivo', 'Substantivo', 'Verbo', 'Adv√©rbio'], answer: 'Adjetivo', explanation: '"Belas" √© uma caracter√≠stica (qualidade) do substantivo "flores".'},
            { q: '17) "O menino, que era muito esperto, resolveu o problema." A ora√ß√£o destacada √©:', options: ['Subordinada adjetiva explicativa', 'Coordenada sind√©tica aditiva', 'Principal', 'Subordinada substantiva'], answer: 'Subordinada adjetiva explicativa', explanation: 'A ora√ß√£o, iniciada por "que" e isolada por v√≠rgulas, adiciona uma qualidade ao termo anterior ("menino").'},
            { q: '18) Qual a forma correta de concord√¢ncia nominal?', options: ['√â necess√°ria paci√™ncia.', '√â necess√°rio paci√™ncia.', 'Paci√™ncia √© necess√°rio.', 'Bastante pessoas vieram.'], answer: ['√â necess√°ria paci√™ncia.'], explanation: 'A express√£o "√© necess√°rio" varia para concordar com o sujeito se ele vier determinado. No entanto, sem artigo, "paci√™ncia" deixa a express√£o invari√°vel, mas o correto √© "√â necess√°ria paci√™ncia" quando o sujeito est√° claro.'},
            { q: '19) Em "Maria foi √† feira. ELA comprou frutas.", o pronome "ELA" serve para:', options: ['Retomar "Maria" (coes√£o)', 'Iniciar uma nova ideia', 'Dar √™nfase', 'Indicar posse'], answer: 'Retomar "Maria" (coes√£o)', explanation: 'O uso do pronome evita a repeti√ß√£o do substantivo "Maria", garantindo a coes√£o textual.'},
            { q: '20) O que √© o predicado de uma ora√ß√£o?', options: ['Tudo o que se declara sobre o sujeito.', 'A palavra mais importante da ora√ß√£o.', 'O mesmo que o sujeito.', 'A a√ß√£o praticada.'], answer: 'Tudo o que se declara sobre o sujeito.', explanation: 'Predicado √© a parte da ora√ß√£o que cont√©m o verbo e informa algo sobre o sujeito.'},
            { q: '21) A palavra "mas" em "Estudou muito, mas n√£o passou" estabelece uma rela√ß√£o de:', options: ['Adversidade', 'Adi√ß√£o', 'Altern√¢ncia', 'Conclus√£o'], answer: 'Adversidade', explanation: 'A conjun√ß√£o "mas" introduz uma ideia contr√°ria √† expectativa gerada pela ora√ß√£o anterior.' },
            { q: '22) "Chegaram os resultados da prova." O sujeito desta ora√ß√£o √©:', options: ['os resultados da prova', 'Resultados', 'Oculto', 'Indeterminado'], answer: 'os resultados da prova', explanation: 'Perguntando ao verbo (O que chegou?), a resposta √© "os resultados da prova". O sujeito est√° posposto (depois do verbo).'},
            { q: '23) A frase "Choveu muito ontem" possui:', options: ['Ora√ß√£o sem sujeito', 'Sujeito oculto', 'Sujeito "muito"', 'Sujeito "ontem"'], answer: 'Ora√ß√£o sem sujeito', explanation: 'Verbos que indicam fen√¥menos da natureza, como "chover", formam ora√ß√µes sem sujeito.'},
            { q: '24) Qual das alternativas apresenta um substantivo abstrato?', options: ['Beleza', 'Mesa', 'Menino', 'Flor'], answer: 'Beleza', explanation: 'Substantivos abstratos nomeiam qualidades, sentimentos, estados ou a√ß√µes, que dependem de outro ser para existir.'},
            { q: '25) Em "Falaram mal de voc√™", o sujeito √©:', options: ['Indeterminado', 'Voc√™', 'Mal', 'Oculto'], answer: 'Indeterminado', explanation: 'O verbo na terceira pessoa do plural, sem um referente claro no texto, indica que o sujeito √© indeterminado.'}
        ];

        let questionOrder = quizData.map((_,i)=>i);
        let currentIndex = 0;
        let questionStatus = Array(quizData.length).fill(null);
        let quizStarted = false;

        function switchView(view){
            if(view==='learn'){
                practiceSection.classList.add('hidden');
                learnSection.classList.remove('hidden');
                btnLearn.classList.replace('btn-ghost', 'btn-primary');
                btnPractice.classList.replace('btn-primary', 'btn-ghost');
            } else {
                learnSection.classList.add('hidden');
                practiceSection.classList.remove('hidden');
                btnPractice.classList.replace('btn-ghost', 'btn-primary');
                btnLearn.classList.replace('btn-primary', 'btn-ghost');
                if (!quizStarted) {
                    startQuiz();
                    quizStarted = true;
                }
            }
        }

        btnLearn.addEventListener('click', () => switchView('learn'));
        btnPractice.addEventListener('click', () => switchView('practice'));

        function renderQuestionButtons(){
            questionButtons.innerHTML='';
            quizData.forEach((_,originalIndex)=>{
                const b = document.createElement('button');
                b.textContent = (originalIndex + 1);
                b.setAttribute('data-original-index', String(originalIndex));
                b.title = `Ir para a quest√£o ${originalIndex+1}`;
                b.onclick = ()=>{
                    const pos = questionOrder.indexOf(originalIndex);
                    if(pos >= 0){ currentIndex = pos; showQuestion(); }
                };
                if(questionStatus[originalIndex]==='correct') b.classList.add('correct-status');
                if(questionStatus[originalIndex]==='wrong') b.classList.add('wrong-status');
                
                if (quizStarted) {
                    const currentQuestionOriginalIndex = questionOrder[currentIndex];
                    if(originalIndex === currentQuestionOriginalIndex) {
                        b.classList.add('current-question');
                    }
                }
                
                questionButtons.appendChild(b);
            });
        }

        const questionProgress = document.createElement('p');
        questionProgress.className='text-sm text-slate-400';
        const questionText = document.createElement('p');
        questionText.className='text-xl mt-2';
        const optionsContainer = document.createElement('div');
        optionsContainer.className='mt-4 grid gap-3';
        const feedbackContainer = document.createElement('div');
        const nextBtn = document.createElement('button');
        nextBtn.className='btn-primary mt-4'; nextBtn.textContent='Pr√≥xima';
        const redoBtn = document.createElement('button');
        redoBtn.className='btn-ghost mt-4 ml-3'; redoBtn.textContent='Refazer';

        quizContainer.appendChild(questionProgress);
        quizContainer.appendChild(questionText);
        quizContainer.appendChild(optionsContainer);
        quizContainer.appendChild(feedbackContainer);
        quizContainer.appendChild(nextBtn);
        quizContainer.appendChild(redoBtn);

        function startQuiz(){
            shuffleArray(questionOrder);
            currentIndex = 0;
            questionStatus.fill(null);
            showQuestion();
        }

        function showQuestion(){
            if (currentIndex >= questionOrder.length) {
                showFinalResults();
                return;
            }
        
            const qIdx = questionOrder[currentIndex];
            const qObj = quizData[qIdx];
            
            questionProgress.textContent = `Quest√£o ${currentIndex+1} de ${quizData.length}`;
            questionText.innerHTML = qObj.q;
            
            optionsContainer.innerHTML='';
            feedbackContainer.innerHTML='';
            redoBtn.classList.add('hidden');
            nextBtn.disabled = true;

            qObj.options.forEach(opt =>{
                const b = document.createElement('button');
                b.className='option-btn'; b.textContent=opt;
                b.onclick = ()=> selectAnswer(b,opt,qObj.answer,qObj.explanation,qIdx);
                optionsContainer.appendChild(b);
            });

            renderQuestionButtons();
        }
        
        function showFinalResults() {
            const correctCount = questionStatus.filter(s => s === 'correct').length;
            const total = quizData.length;
            questionProgress.textContent = `Quiz finalizado!`;
            questionText.innerHTML = `üéâ Fim do Quiz! üéâ`;
            optionsContainer.innerHTML = `<p class="text-center text-lg">Voc√™ acertou ${correctCount} de ${total} quest√µes.</p>`;
            feedbackContainer.innerHTML = '';
            nextBtn.textContent = 'Recome√ßar Quiz';
            nextBtn.disabled = false;
            nextBtn.onclick = () => {
                quizStarted = false;
                startQuiz(); 
                quizStarted = true;
            };
            redoBtn.classList.add('hidden');
        }

        function selectAnswer(btn,opt,correct,explanation,qIdx){
            Array.from(optionsContainer.children).forEach(b=>b.disabled=true);
            nextBtn.disabled = false;

            if(opt===correct){
                btn.classList.add('celebrate','correct');
                createConfetti();
                questionStatus[qIdx]='correct';
                feedbackContainer.className='feedback-correct mt-4';
                feedbackContainer.textContent = 'Correto! ' + (explanation || '');
            } else {
                btn.classList.add('wrong');
                questionStatus[qIdx]='wrong';
                feedbackContainer.className='feedback-wrong mt-4';
                feedbackContainer.innerHTML = `<strong>Errado.</strong> Resposta correta: <strong>${correct}</strong>.`;
                if(explanation) feedbackContainer.innerHTML += `<div class="mt-2 text-sm">${explanation}</div>`;
                
                Array.from(optionsContainer.children).forEach(b=>{
                    if(b.textContent === correct) b.classList.add('correct');
                });
                redoBtn.classList.remove('hidden');
            }
            renderQuestionButtons();
        }

        nextBtn.addEventListener('click', ()=>{
            if(currentIndex < questionOrder.length-1){ 
                currentIndex++; 
                showQuestion(); 
            } else { 
                currentIndex++;
                showFinalResults();
            }
        });

        redoBtn.addEventListener('click', ()=>{
            const currentQuestionIndex = questionOrder[currentIndex];
            questionStatus[currentQuestionIndex] = null;
            showQuestion();
        });

        function shuffleArray(a){
            for(let i=a.length-1;i>0;i--){ const j=Math.floor(Math.random()*(i+1)); [a[i],a[j]]=[a[j],a[i]]; }
        }

        function createConfetti(){
            const colors = ['#f59e0b','#ef4444','#10b981','#3b82f6','#8b5cf6'];
            for(let i=0;i<12;i++){
                const el = document.createElement('div');
                el.className='confetti';
                el.style.left = (30 + Math.random()*40) + '%';
                el.style.top = (10 + Math.random()*10) + 'vh';
                el.style.color = colors[Math.floor(Math.random()*colors.length)];
                el.textContent = 'üéâ';
                el.style.transform = `rotate(${Math.random()*360}deg)`;
                el.style.animation = `confetti-fall ${1.2 + Math.random()*1}s linear forwards`;
                document.body.appendChild(el);
                setTimeout(()=> el.remove(), 2200);
            }
        }
        
        switchView('learn');
    });
    </script>
</body>
</html>
